<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Turbulence · ClimateMachine</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../GettingStarted/Installation/">Installation</a></li><li><a class="tocitem" href="../../../../GettingStarted/RunningClimateMachine/">Running</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Defaults</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../GettingStarted/Atmos/">Atmosphere model configurations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Atmos/heldsuarez/">Dry Idealized GCM</a></li><li><a class="tocitem" href="../../../../generated/Atmos/risingbubble/">Rising Thermal Bubble</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Heat</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Land/Heat/heat_equation/">Heat Equation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-4-1" type="checkbox"/><label class="tocitem" for="menuitem-3-4-1"><span class="docs-label">LinearSolvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/Numerics/LinearSolvers/cg/">Conjugate Gradient</a></li><li><a class="tocitem" href="../../../../generated/Numerics/LinearSolvers/bgmres/">Batched Generalized Minimal Residual</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../generated/literate_markdown/">Notes on Literate</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Common/MoistThermodynamics/">MoistThermodynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Atmos/TemperatureProfiles/">TemperatureProfiles</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-4-5-2" type="checkbox"/><label class="tocitem" for="menuitem-4-5-2"><span class="docs-label">DG methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/DGmethods/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-3" type="checkbox"/><label class="tocitem" for="menuitem-4-5-3"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-4" type="checkbox"/><label class="tocitem" for="menuitem-4-5-4"><span class="docs-label">Linear Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/LinearSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../../APIs/Atmos/Microphysics/">Microphysics</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Common/SurfaceFluxes/">Surface Fluxes</a></li></ul></li><li><a class="tocitem" href="../../../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Diagnostics/Diagnostics/">List of variables</a></li><li><a class="tocitem" href="../../../../APIs/Diagnostics/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/LinearSolvers/LinearSolvers/">LinearSolvers</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../../../APIs/Numerics/DGmethods/BalanceLawOverview/">Balance Law</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Common/SurfaceFluxes/">SurfaceFluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox" checked/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../Microphysics/">Microphysics</a></li><li><a class="tocitem" href="../../EDMFEquations/">EDMF equations</a></li><li class="is-active"><a class="tocitem" href>Turbulence</a><ul class="internal"><li><a class="tocitem" href="#Turbulence-Closures-docs-1"><span>Turbulence Closures</span></a></li><li><a class="tocitem" href="#Abstract-Type-1"><span>Abstract Type</span></a></li><li><a class="tocitem" href="#Eddy-viscosity-Models-1"><span>Eddy-viscosity Models</span></a></li><li><a class="tocitem" href="#smagorinsky-lilly-1"><span>Smagorinsky-Lilly</span></a></li><li><a class="tocitem" href="#vreman-1"><span>Vreman Model</span></a></li><li><a class="tocitem" href="#aniso-min-diss-1"><span>Anisotropic Minimum Dissipation</span></a></li></ul></li><li><a class="tocitem" href="../tracers/">Tracers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../DevDocs/CodeStyle/">Coding style</a></li><li><a class="tocitem" href="../../../../DevDocs/AcceptableUnicode/">Acceptable Unicode</a></li><li><a class="tocitem" href="../../../../DevDocs/VariableList/">Variable list</a></li><li><a class="tocitem" href="../../../../DevDocs/DiagnosticVariables/">Diagnostic variable list</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li><a class="is-disabled">Atmos</a></li><li class="is-active"><a href>Turbulence</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Turbulence</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Turbulence-Closures-docs-1"><a class="docs-heading-anchor" href="#Turbulence-Closures-docs-1">Turbulence Closures</a><a class="docs-heading-anchor-permalink" href="#Turbulence-Closures-docs-1" title="Permalink"></a></h2><p>In <code>turbulence.jl</code> we specify turbulence closures. Currently, pointwise models of the eddy viscosity/eddy diffusivity type are supported for turbulent shear and tracer diffusivity. Methods currently supported are:<br/><a href="#constant-viscosity-1"><code>ConstantViscosityWithDivergence</code></a><br/><a href="#smagorinsky-lilly-1"><code>SmagorinskyLilly</code></a><br/><a href="#vreman-1"><code>Vreman</code></a><br/><a href="#aniso-min-diss-1"><code>AnisoMinDiss</code></a><br/></p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Usage: This is a quick-ref guide to using turbulence models as a subcomponent of <code>AtmosModel</code> <br/><span>$\nu$</span> is the kinematic viscosity, <span>$C_smag$</span> is the Smagorinsky Model coefficient,</p><ul><li><code>turbulence=ConstantViscosityWithDivergence(ν)</code><br/></li><li><code>turbulence=SmagorinskyLilly(C_smag)</code><br/></li><li><code>turbulence=Vreman(C_smag)</code><br/></li><li><code>turbulence=AnisoMinDiss(C_poincare)</code></li></ul></div></div><pre><code class="language-julia">using DocStringExtensions
using CLIMAParameters.Atmos.SubgridScale: inv_Pr_turb
export ConstantViscosityWithDivergence, SmagorinskyLilly, Vreman, AnisoMinDiss
export turbulence_tensors</code></pre><h2 id="Abstract-Type-1"><a class="docs-heading-anchor" href="#Abstract-Type-1">Abstract Type</a><a class="docs-heading-anchor-permalink" href="#Abstract-Type-1" title="Permalink"></a></h2><p>We define a <code>TurbulenceClosure</code> abstract type and default functions for the generic turbulence closure which will be overloaded with model specific functions. Minimally, overloaded functions for the following stubs must be defined for a turbulence model.</p><pre><code class="language-julia">abstract type TurbulenceClosure end


vars_state_gradient((::TurbulenceClosure, FT) = @vars()
vars_state_gradient_flux(::TurbulenceClosure, FT) = @vars()
vars_state_auxiliary(::TurbulenceClosure, FT) = @vars()

function atmos_init_aux!(
    ::TurbulenceClosure,
    ::AtmosModel,
    aux::Vars,
    geom::LocalGeometry,
) end
function compute_gradient_argument!(
    ::TurbulenceClosure,
    transform::Vars,
    state::Vars,
    aux::Vars,
    t::Real,
) end
function compute_gradient_flux!(
    ::TurbulenceClosure,
    ::Orientation,
    diffusive,
    ∇transform,
    state,
    aux,
    t,
) end</code></pre><p>The following may need to be addressed if turbulence models require additional state variables or auxiliary variable updates (e.g. TKE based models)</p><pre><code class="language-julia">vars_state_conservative(::TurbulenceClosure, FT) = @vars()
function atmos_nodal_update_auxiliary_state!(
    ::TurbulenceClosure,
    ::AtmosModel,
    state::Vars,
    aux::Vars,
    t::Real,
) end</code></pre><h2 id="Eddy-viscosity-Models-1"><a class="docs-heading-anchor" href="#Eddy-viscosity-Models-1">Eddy-viscosity Models</a><a class="docs-heading-anchor-permalink" href="#Eddy-viscosity-Models-1" title="Permalink"></a></h2><p>The following function provides an example of a stub for an eddy-viscosity model.  Currently, scalar and diagonal tensor viscosities and diffusivities are supported.</p><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.turbulence_tensors" href="#ClimateMachine.Atmos.turbulence_tensors"><code>ClimateMachine.Atmos.turbulence_tensors</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ν, D_t, τ = turbulence_tensors(
                ::TurbulenceClosure,
                orientation::Orientation,
                param_set::AbstractParameterSet,
                state::Vars,
                diffusive::Vars,
                aux::Vars,
                t::Real
            )</code></pre><p>Compute the kinematic viscosity (<code>ν</code>), the diffusivity (<code>D_t</code>) and SGS momentum flux tensor (<code>τ</code>) for a given turbulence closure. Each closure overloads this method with the appropriate calculations for the returned quantities.</p><p><strong>Arguments</strong></p><ul><li><code>::TurbulenceClosure</code> = Struct identifier for turbulence closure model</li><li><code>orientation</code> = <code>AtmosModel.orientation</code></li><li><code>param_set</code> = <code>AtmosModel.param_set</code></li><li><code>state</code> = Array of prognostic (state) variables. See <code>vars_state_conservative</code> in <code>AtmosModel</code></li><li><code>diffusive</code> = Array of diffusive variables</li><li><code>aux</code> = Array of auxiliary variables</li><li><code>t</code> = time</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L90-L113">source</a></section></article><p>Generic math functions for use within the turbulence closures such as the <a href="#tensor-invariants-1">principal tensor invariants</a>, <a href="#symmetric-tensors-1">symmetric tensors</a> and <a href="#tensor-norms-1">tensor norms</a> have been included.</p><h3 id="tensor-invariants-1"><a class="docs-heading-anchor" href="#tensor-invariants-1">Pricipal Invariants</a><a class="docs-heading-anchor-permalink" href="#tensor-invariants-1" title="Permalink"></a></h3><div>\[\textit{I}_{1} = \mathrm{tr(X)} \\
\textit{I}_{2} = (\mathrm{tr(X)}^2 - \mathrm{tr(X)^2}) / 2 \\
\textit{I}_{3} = \mathrm{det(X)} \\\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.principal_invariants" href="#ClimateMachine.Atmos.principal_invariants"><code>ClimateMachine.Atmos.principal_invariants</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">principal_invariants(X)</code></pre><p>Calculates principal invariants of a tensor <code>X</code>. Returns 3 element tuple containing the invariants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L127-L131">source</a></section></article><h3 id="symmetric-tensors-1"><a class="docs-heading-anchor" href="#symmetric-tensors-1">Symmetrize</a><a class="docs-heading-anchor-permalink" href="#symmetric-tensors-1" title="Permalink"></a></h3><div>\[\frac{\mathrm{X} + \mathrm{X}^{T}}{2} \\\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.symmetrize" href="#ClimateMachine.Atmos.symmetrize"><code>ClimateMachine.Atmos.symmetrize</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">symmetrize(X)</code></pre><p>Given a (3,3) second rank tensor X, compute <code>(X + X&#39;)/2</code>, returning a symmetric <code>SHermitianCompact</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L143-L148">source</a></section></article><h3 id="tensor-norms-1"><a class="docs-heading-anchor" href="#tensor-norms-1">2-Norm</a><a class="docs-heading-anchor-permalink" href="#tensor-norms-1" title="Permalink"></a></h3><p>Given a tensor X, return the tensor dot product</p><div>\[\sum_{i,j} S_{ij}^2\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.norm2" href="#ClimateMachine.Atmos.norm2"><code>ClimateMachine.Atmos.norm2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">norm2(X)</code></pre><p>Given a tensor <code>X</code>, computes its tensor dot product.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L165-L168">source</a></section></article><h3 id="strain-rate-magnitude-1"><a class="docs-heading-anchor" href="#strain-rate-magnitude-1">Strain-rate Magnitude</a><a class="docs-heading-anchor-permalink" href="#strain-rate-magnitude-1" title="Permalink"></a></h3><p>By definition, the strain-rate magnitude, as defined in standard turbulence modelling is computed such that</p><div>\[|\mathrm{S}| = \sqrt{2 \sum_{i,j} \mathrm{S}_{ij}^2}\]</div><p>where</p><div>\[\vec{S}(\vec{u}) = \frac{1}{2}  \left(\nabla\vec{u} +  \left( \nabla\vec{u} \right)^T \right)\]</div><p>\mathrm{S} is the rate-of-strain tensor. (Symmetric component of the velocity gradient). Note that the skew symmetric component (rate-of-rotation) is not currently computed.</p><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.strain_rate_magnitude" href="#ClimateMachine.Atmos.strain_rate_magnitude"><code>ClimateMachine.Atmos.strain_rate_magnitude</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">strain_rate_magnitude(S)</code></pre><p>Given the rate-of-strain tensor <code>S</code>, computes its magnitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L201-L204">source</a></section></article><pre><code class="language-julia">&quot;&quot;&quot;
    strain_rate_magnitude(S)
Given the rate-of-strain tensor `S`, computes its magnitude.
&quot;&quot;&quot;
function strain_rate_magnitude(S::SHermitianCompact{3, FT, 6}) where {FT}
    return sqrt(2 * norm2(S))
end</code></pre><h3 id="constant-viscosity-1"><a class="docs-heading-anchor" href="#constant-viscosity-1">Constant Viscosity Model</a><a class="docs-heading-anchor-permalink" href="#constant-viscosity-1" title="Permalink"></a></h3><p><code>ConstantViscosityWithDivergence</code> requires a user to specify the constant viscosity (kinematic) and appropriately computes the turbulent stress tensor based on this term. Diffusivity can be computed using the turbulent Prandtl number for the appropriate problem regime.</p><div>\[\tau = - 2 \nu \mathrm{S}\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.ConstantViscosityWithDivergence" href="#ClimateMachine.Atmos.ConstantViscosityWithDivergence"><code>ClimateMachine.Atmos.ConstantViscosityWithDivergence</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ConstantViscosityWithDivergence &lt;: TurbulenceClosure</code></pre><p>Turbulence with constant dynamic viscosity (<code>ρν</code>). Divergence terms are included in the momentum flux tensor.</p><p><strong>Fields</strong></p><ul><li><p><code>ρν</code></p><p>Dynamic Viscosity [kg/m/s]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L216-L225">source</a></section></article><h2 id="smagorinsky-lilly-1"><a class="docs-heading-anchor" href="#smagorinsky-lilly-1">Smagorinsky-Lilly</a><a class="docs-heading-anchor-permalink" href="#smagorinsky-lilly-1" title="Permalink"></a></h2><p>The Smagorinsky turbulence model, with Lilly&#39;s correction to stratified atmospheric flows, is included in ClimateMachine. The input parameter to this model is the Smagorinsky coefficient. For atmospheric flows, the coefficient <code>C_smag</code> typically takes values between 0.15 and 0.23. Flow dependent <code>C_smag</code> are currently not supported (e.g. Germano&#39;s extension). The Smagorinsky-Lilly model does not contain explicit filtered terms.</p><h4 id="Equations-1"><a class="docs-heading-anchor" href="#Equations-1">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-1" title="Permalink"></a></h4><div>\[\nu = (C_{s} \mathrm{f}_{b} \Delta)^2 \sqrt{|\mathrm{S}|}\]</div><p>with the stratification correction term</p><div>\[f_{b} =
   \begin{cases}
   1 &amp; \mathrm{Ri} \leq 0 ,\\
   \max(0, 1 - \mathrm{Ri} / \mathrm{Pr}_{t})^{1/4} &amp; \mathrm{Ri} &gt; 0 .
   \end{cases}\]</div><div>\[\mathrm{Ri} =  \frac{N^2}{{|S|}^2}\]</div><div>\[N = \left( \frac{g}{\theta_v} \frac{\partial \theta_v}{\partial z}\right)^{1/2}\]</div><p>Here, <span>$\mathrm{Ri}$</span> and <span>$\mathrm{Pr}_{t}$</span> are the Richardson and turbulent Prandtl numbers respectively.  <span>$\Delta$</span> is the mixing length in the relevant coordinate direction. We use the DG metric terms to determine the local effective resolution (see <code>src/Mesh/Geometry.jl</code>), and modify the vertical lengthscale by the stratification correction factor <span>$\mathrm{f}_{b}$</span> so that <span>$\Delta_{vert} = \Delta z f_b$</span>.</p><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.SmagorinskyLilly" href="#ClimateMachine.Atmos.SmagorinskyLilly"><code>ClimateMachine.Atmos.SmagorinskyLilly</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SmagorinskyLilly &lt;: TurbulenceClosure</code></pre><p><strong>Fields</strong></p><ul><li><p><code>C_smag</code></p><p>Smagorinsky Coefficient [dimensionless]</p></li></ul><p><strong>Smagorinsky Model Reference</strong></p><pre><code class="language-none">article{doi:10.1175/1520-0493(1963)091&lt;0099:GCEWTP&gt;2.3.CO;2,
  author = {Smagorinksy, J.},
  title = {General circulation experiments with the primitive equations},
  journal = {Monthly Weather Review},
  volume = {91},
  number = {3},
  pages = {99-164},
  year = {1963},
  doi = {10.1175/1520-0493(1963)091&lt;0099:GCEWTP&gt;2.3.CO;2},
  URL = {https://doi.org/10.1175/1520-0493(1963)091&lt;0099:GCEWTP&gt;2.3.CO;2},
  eprint = {https://doi.org/10.1175/1520-0493(1963)091&lt;0099:GCEWTP&gt;2.3.CO;2}
  }</code></pre><p><strong>Lilly Model Reference</strong></p><pre><code class="language-none">article{doi:10.1111/j.2153-3490.1962.tb00128.x,
  author = {LILLY, D. K.},
  title = {On the numerical simulation of buoyant convection},
  journal = {Tellus},
  volume = {14},
  number = {2},
  pages = {148-172},
  doi = {10.1111/j.2153-3490.1962.tb00128.x},
  url = {https://onlinelibrary.wiley.com/doi/abs/10.1111/j.2153-3490.1962.tb00128.x},
  eprint = {https://onlinelibrary.wiley.com/doi/pdf/10.1111/j.2153-3490.1962.tb00128.x},
  year = {1962}
  }</code></pre><p><strong>Brunt-Väisälä Frequency Reference</strong></p><pre><code class="language-none">Brunt-Vaisala frequency N² defined as in equation (1b) in
  Durran, D.R. and J.B. Klemp, 1982:
  On the Effects of Moisture on the Brunt-Väisälä Frequency.
  J. Atmos. Sci., 39, 2152–2158,
  https://doi.org/10.1175/1520-0469(1982)039&lt;2152:OTEOMO&gt;2.0.CO;2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L297-L340">source</a></section></article><h2 id="vreman-1"><a class="docs-heading-anchor" href="#vreman-1">Vreman Model</a><a class="docs-heading-anchor-permalink" href="#vreman-1" title="Permalink"></a></h2><p>Vreman&#39;s turbulence model for anisotropic flows, which provides a less dissipative solution (specifically in the near-wall and transitional regions) than the Smagorinsky-Lilly method. This model relies of first derivatives of the velocity vector (i.e., the gradient tensor).  By design, the Vreman model handles transitional as well as fully turbulent flows adequately. The input parameter to this model is the Smagorinsky coefficient - the coefficient is modified within the model functions to account for differences in model construction.</p><h4 id="Equations-2"><a class="docs-heading-anchor" href="#Equations-2">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-2" title="Permalink"></a></h4><div>\[\nu_{t} = 2.5 C_{s}^2 \sqrt{\frac{B_{\beta}}{u_{i,j}u_{i,j}}},\]</div><p>where (<span>$i,j, m = (1,2,3)$</span>)</p><div>\[\begin{align}
B_{\beta} &amp;= \beta_{11}\beta_{22} + \beta_{11}\beta_{33} + \beta_{22}\beta_{33} - (\beta_{13}^2 + \beta_{12}^2 + \beta_{23}^2) \\
\beta_{ij} &amp;= \Delta_{m}^2 u_{i, m} u_{j, m} \\
u_{i,j} &amp;= \frac{\partial u_{i}}{\partial x_{j}}.
\end{align}\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.Vreman" href="#ClimateMachine.Atmos.Vreman"><code>ClimateMachine.Atmos.Vreman</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Vreman{FT} &lt;: TurbulenceClosure</code></pre><p>Filter width Δ is the local grid resolution calculated from the mesh metric tensor. A Smagorinsky coefficient is specified and used to compute the equivalent Vreman coefficient.</p><ol><li>ν_e = √(Bᵦ/(αᵢⱼαᵢⱼ)) where αᵢⱼ = ∂uⱼ∂uᵢ with uᵢ the resolved scale velocity component.</li><li>βij = Δ²αₘᵢαₘⱼ</li><li>Bᵦ = β₁₁β₂₂ + β₂₂β₃₃ + β₁₁β₃₃ - β₁₂² - β₁₃² - β₂₃²</li></ol><p>βᵢⱼ is symmetric, positive-definite. If Δᵢ = Δ, then β = Δ²αᵀα</p><p><strong>Fields</strong></p><ul><li><p><code>C_smag</code></p><p>Smagorinsky Coefficient [dimensionless]</p></li></ul><p><strong>Reference</strong></p><pre><code class="language-none">@article{Vreman2004,
  title={An eddy-viscosity subgrid-scale model for turbulent shear flow: Algebraic theory and applications},
  author={Vreman, AW},
  journal={Physics of fluids},
  volume={16},
  number={10},
  pages={3670--3681},
  year={2004},
  publisher={AIP}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L436-L465">source</a></section></article><h2 id="aniso-min-diss-1"><a class="docs-heading-anchor" href="#aniso-min-diss-1">Anisotropic Minimum Dissipation</a><a class="docs-heading-anchor-permalink" href="#aniso-min-diss-1" title="Permalink"></a></h2><p>This method is based Vreugdenhil and Taylor&#39;s minimum-dissipation eddy-viscosity model.  The principles of the Rayleigh quotient minimizer are applied to the energy dissipation terms in the conservation equations, resulting in a maximum dissipation bound, and a model for eddy viscosity and eddy diffusivity.</p><div>\[\nu_e = (\mathrm{C}\delta)^2  \mathrm{max}\left[0, - \frac{\hat{\partial}_k \hat{u}_{i} \hat{\partial}_k \hat{u}_{j} \mathrm{\hat{S}}_{ij}}{\hat{\partial}_p \hat{u}_{q} \hat{\partial}_p \hat{u}_{q}} \right]\]</div><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.Atmos.AnisoMinDiss" href="#ClimateMachine.Atmos.AnisoMinDiss"><code>ClimateMachine.Atmos.AnisoMinDiss</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AnisoMinDiss{FT} &lt;: TurbulenceClosure</code></pre><p>Filter width Δ is the local grid resolution calculated from the mesh metric tensor. A Poincare coefficient is specified and used to compute the equivalent AnisoMinDiss coefficient (computed as the solution to the eigenvalue problem for the Laplacian operator).</p><p><strong>Fields</strong></p><ul><li><code>C_poincare</code></li></ul><p><strong>Reference</strong></p><pre><code class="language-none">@article{
    doi:10.1063/1.5037039,
    author = {Vreugdenhil,Catherine A.  and Taylor,John R. },
    title = {Large-eddy simulations of stratified plane Couette flow using the anisotropic minimum-dissipation model},
    journal = {Physics of Fluids},
    volume = {30},
    number = {8},
    pages = {085104},
    year = {2018},
    doi = {10.1063/1.5037039},
    URL = {https://doi.org/10.1063/1.5037039}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/f71b866139ba1bc262b89e1cc63dcaad5f3f966d/src/Atmos/Model/turbulence.jl#L542-L567">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../EDMFEquations/">« EDMF equations</a><a class="docs-footer-nextpage" href="../tracers/">Tracers »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 12:31">Wednesday 27 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

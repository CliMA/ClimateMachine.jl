<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coding style · ClimateMachine</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GettingStarted/Installation/">Installation</a></li><li><a class="tocitem" href="../../GettingStarted/RunningClimateMachine/">Running</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Defaults</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../GettingStarted/Atmos/">Atmosphere model configurations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/Atmos/heldsuarez/">Dry Idealized GCM</a></li><li><a class="tocitem" href="../../generated/Atmos/risingbubble/">Rising Thermal Bubble</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-3-1"><span class="docs-label">Heat</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/Land/Heat/heat_equation/">Heat Equation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-4-1" type="checkbox"/><label class="tocitem" for="menuitem-3-4-1"><span class="docs-label">LinearSolvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/Numerics/LinearSolvers/cg/">Conjugate Gradient</a></li><li><a class="tocitem" href="../../generated/Numerics/LinearSolvers/bgmres/">Batched Generalized Minimal Residual</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Contributing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../generated/literate_markdown/">Notes on Literate</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../HowToGuides/Common/MoistThermodynamics/">MoistThermodynamics</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../HowToGuides/Atmos/TemperatureProfiles/">TemperatureProfiles</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-4-5-2" type="checkbox"/><label class="tocitem" for="menuitem-4-5-2"><span class="docs-label">DG methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../HowToGuides/Numerics/DGmethods/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-3" type="checkbox"/><label class="tocitem" for="menuitem-4-5-3"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../HowToGuides/Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-4" type="checkbox"/><label class="tocitem" for="menuitem-4-5-4"><span class="docs-label">Linear Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../HowToGuides/Numerics/LinearSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../APIs/Atmos/Microphysics/">Microphysics</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/Common/SurfaceFluxes/">Surface Fluxes</a></li></ul></li><li><a class="tocitem" href="../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/Diagnostics/Diagnostics/">List of variables</a></li><li><a class="tocitem" href="../../APIs/Diagnostics/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../APIs/Numerics/LinearSolvers/LinearSolvers/">LinearSolvers</a></li><li><a class="tocitem" href="../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../APIs/Numerics/DGmethods/BalanceLawOverview/">Balance Law</a></li></ul></li></ul></li><li><a class="tocitem" href="../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Theory/Common/SurfaceFluxes/">SurfaceFluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Theory/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../Theory/Atmos/Microphysics/">Microphysics</a></li><li><a class="tocitem" href="../../Theory/Atmos/EDMFEquations/">EDMF equations</a></li><li><a class="tocitem" href="../../Theory/Atmos/Model/turbulence/">Turbulence</a></li><li><a class="tocitem" href="../../Theory/Atmos/Model/tracers/">Tracers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox" checked/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Coding style</a><ul class="internal"><li><a class="tocitem" href="#Use-JuliaFormatter-1"><span>Use <code>JuliaFormatter</code></span></a></li></ul></li><li><a class="tocitem" href="../AcceptableUnicode/">Acceptable Unicode</a></li><li><a class="tocitem" href="../VariableList/">Variable list</a></li><li><a class="tocitem" href="../DiagnosticVariables/">Diagnostic variable list</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer docs</a></li><li class="is-active"><a href>Coding style</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Coding style</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimateMachine.jl/blob/master/docs/src/DevDocs/CodeStyle.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Coding-conventions-1"><a class="docs-heading-anchor" href="#Coding-conventions-1">Coding conventions</a><a class="docs-heading-anchor-permalink" href="#Coding-conventions-1" title="Permalink"></a></h1><p>For the most part, we follow the <a href="https://github.com/jrevels/YASGuide">YASGuide</a>. Some key considerations:</p><ul><li><p>Limit use of Unicode as described in <a href="../AcceptableUnicode/">AcceptableUnicode</a>.</p></li><li><p>Modules and struct names should follow TitleCase convention.</p></li><li><p>Function names should be lowercase with words separated by underscores as necessary to improve readability.</p></li><li><p>Variable names follow the format used in the <a href="../VariableList/">Variable List</a>. In addition, follow <a href="http://clipc-services.ceda.ac.uk/dreq/">CMIP conventions</a> where possible and practicable.</p></li><li><p>Document design and purpose rather than mechanics and implementation (document interfaces and embed documentation in code).</p></li><li><p>Avoid variable names that coincide with module and struct names, as well as function/variable names that are natively supported.</p></li><li><p>Never use the characters <code>l</code> (lowercase letter &#39;el&#39;), <code>O</code> (uppercase letter &#39;oh&#39;), or <code>I</code> (uppercase letter &#39;eye&#39;) as single character variable names.</p></li><li><p>Try to limit all lines to a maximum of 78 characters.</p></li><li><p><code>import</code>/<code>using</code> should be grouped in the following order:</p><ul><li>Standard library imports.</li><li>Related third party imports.</li><li>Local application/library specific imports.</li><li>Use a blank line between each group of imports.</li></ul></li></ul><h2 id="Use-JuliaFormatter-1"><a class="docs-heading-anchor" href="#Use-JuliaFormatter-1">Use <code>JuliaFormatter</code></a><a class="docs-heading-anchor-permalink" href="#Use-JuliaFormatter-1" title="Permalink"></a></h2><p>Once you are happy with your PR, apply our <a href="https://domluna.github.io/JuliaFormatter.jl/stable/">JuliaFormatter.jl</a> settings to all changed files in the repository from the top-level <code>ClimateMachine</code> directory:</p><pre><code class="language-none">julia .dev/climaformat.jl &lt;list of changed files&gt;</code></pre><p>This is easiest done by installing our formatting <code>githook</code>.</p><h3 id="Formatting-githook-1"><a class="docs-heading-anchor" href="#Formatting-githook-1">Formatting <code>githook</code></a><a class="docs-heading-anchor-permalink" href="#Formatting-githook-1" title="Permalink"></a></h3><p>A <code>pre-commit</code> script can be placed in <code>$GIT_DIR/hooks/*</code> which will prevent commits of incorrectly formatted Julia code.  It will also provide instructions on how to format the code correctly.</p><p>Install the script with:</p><pre><code class="language-none">$ ln -s ../../.dev/hooks/pre-commit .git/hooks</code></pre><p>Then, when you run <code>git commit</code>, an error message will be shown for staged Julia files that are not formatted correctly. For example, if you try to commit changes to <code>src/Arrays/MPIStateArrays.jl</code> that are not formatted correctly:</p><pre><code class="language-none">❯ git commit                                                                                                           │
Activating environment at `~/research/code/ClimateMachine.jl/.dev/Project.toml`                                        │
┌ Error: File src/Arrays/MPIStateArrays.jl needs to be indented with:                                                  │
│     julia /home/lucas/research/code/ClimateMachine.jl/.dev/climaformat.jl /home/lucas/research/code/ClimateMachine.jl│
/src/Arrays/MPIStateArrays.jl                                                                                          │
│ and added to the git index via                                                                                       │
│     git add /home/lucas/research/code/ClimateMachine.jl/src/Arrays/MPIStateArrays.jl                                 │
└ @ Main ~/research/code/ClimateMachine.jl/.git/hooks/pre-commit:30</code></pre><p>Learn more about <a href="https://www.atlassian.com/git/tutorials/git-hooks"><code>git hooks</code></a>.</p><h3 id="Precompiling-JuliaFormatter-1"><a class="docs-heading-anchor" href="#Precompiling-JuliaFormatter-1">Precompiling <code>JuliaFormatter</code></a><a class="docs-heading-anchor-permalink" href="#Precompiling-JuliaFormatter-1" title="Permalink"></a></h3><p>To speed up the formatter and the githook, a custom system image can be built with the [<code>PackageCompiler</code>]. That said, the following [drawback] from the <code>PackageCompiler</code> repository should be noted:</p><blockquote><p>It should be clearly stated that there are some drawbacks to using a custom sysimage, thereby sidestepping the standard Julia package precompilation system. The biggest drawback is that packages that are compiled into a sysimage (including their dependencies!) are &quot;locked&quot; to the version they where at when the sysimage was created. This means that no matter what package version you have installed in your current project, the one in the sysimage will take precedence. This can lead to bugs where you start with a project that needs a specific version of a package, but you have another one compiled into the sysimage.</p></blockquote><p>The <code>PackageCompiler</code> compiler can be used with <code>JuliaFormatter</code> using the following commands (from the top-level directory of a clone of <code>ClimateMachine</code>):</p><pre><code class="language-none">$ julia -q
julia&gt; using Pkg
julia&gt; Pkg.add(&quot;PackageCompiler&quot;)
julia&gt; using PackageCompiler
julia&gt; Pkg.activate(joinpath(@__DIR__, &quot;.dev&quot;))
julia&gt; using PackageCompiler
julia&gt; PackageCompiler.create_sysimage(:JuliaFormatter; precompile_execution_file=joinpath(@__DIR__, &quot;.dev/precompile.jl&quot;), replace_default=true)</code></pre><p>If you cannot or do not want to modify the default system image, use the following instead:</p><pre><code class="language-none">$ julia -q
julia&gt; using Pkg
julia&gt; Pkg.add(&quot;PackageCompiler&quot;)
julia&gt; using PackageCompiler
julia&gt; Pkg.activate(joinpath(@__DIR__, &quot;.dev&quot;))
julia&gt; PackageCompiler.create_sysimage(:JuliaFormatter; precompile_execution_file=joinpath(@__DIR__, &quot;.dev/precompile.jl&quot;), sysimage_path=joinpath(@__DIR__, &quot;.git/hooks/JuliaFormatterSysimage.so&quot;))</code></pre><p>In this case, use the <code>pre-commit.sysimage</code> <code>git hook</code> with:</p><pre><code class="language-none">$ ln -s ../../.dev/hooks/pre-commit.sysimage .git/hooks/pre-commit</code></pre><p>Note: Putting the system image in <code>.git/hooks</code> protects it from calls to <code>git clean -x</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Theory/Atmos/Model/tracers/">« Tracers</a><a class="docs-footer-nextpage" href="../AcceptableUnicode/">Acceptable Unicode »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 27 May 2020 12:30">Wednesday 27 May 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

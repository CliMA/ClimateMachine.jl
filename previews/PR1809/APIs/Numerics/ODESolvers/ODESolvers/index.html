<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ODESolvers · ClimateMachine</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../GettingStarted/Installation/">Installation</a></li><li><a class="tocitem" href="../../../../GettingStarted/Terminology/">Terminology</a></li><li><a class="tocitem" href="../../../../GettingStarted/RunningClimateMachine/">Running</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Defaults</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../GettingStarted/Atmos/">Atmosphere model configurations</a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Common/Thermodynamics/">Thermodynamics</a></li><li><a class="tocitem" href="../../../../HowToGuides/Common/UniversalFunctions/">Universal Functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Atmos/TemperatureProfiles/">Temperature profiles</a></li><li><a class="tocitem" href="../../../../HowToGuides/Atmos/AtmosReferenceState/">Reference profiles</a></li><li><a class="tocitem" href="../../../../HowToGuides/Atmos/MoistureModelChoices/">Moisture model</a></li><li><a class="tocitem" href="../../../../HowToGuides/Atmos/PrecipitationModelChoices/">Precipitation model</a></li><li><a class="tocitem" href="../../../../HowToGuides/Atmos/MoistureAndPrecip/">How to create an experiment with moisture and precipitation</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-4-5-2" type="checkbox"/><label class="tocitem" for="menuitem-4-5-2"><span class="docs-label">DG methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/DGMethods/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-3" type="checkbox"/><label class="tocitem" for="menuitem-4-5-3"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-4" type="checkbox"/><label class="tocitem" for="menuitem-4-5-4"><span class="docs-label">System Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Numerics/SystemSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../HowToGuides/Diagnostics/UsingDiagnostics/">Using Diagnostics</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Driver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Driver/">Top level interface</a></li><li><a class="tocitem" href="../../../Driver/Checkpoint/">Checkpoint</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../Atmos/Microphysics_0M/">Microphysics_0M</a></li><li><a class="tocitem" href="../../../Atmos/Microphysics/">Microphysics</a></li><li><a class="tocitem" href="../../../Atmos/TemperatureProfiles/">Temperature Profiles</a></li></ul></li><li><a class="tocitem" href="../../../Ocean/Ocean/">Ocean</a></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Land/LandModel/">Land Model</a></li><li><a class="tocitem" href="../../../Land/Runoff/">Runoff Parameterizations</a></li><li><a class="tocitem" href="../../../Land/SoilWaterParameterizations/">Soil Water Parameterizations</a></li><li><a class="tocitem" href="../../../Land/SoilHeatParameterizations/">Soil Heat Parameterizations</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Common/Orientations/">Orientations</a></li><li><a class="tocitem" href="../../../Common/Spectra/">Spectra</a></li><li><a class="tocitem" href="../../../Common/SurfaceFluxes/">Surface Fluxes</a></li><li><a class="tocitem" href="../../../Common/Thermodynamics/">Thermodynamics</a></li><li><a class="tocitem" href="../../../Common/TurbulenceClosures/">Turbulence Closures</a></li><li><a class="tocitem" href="../../../Common/TurbulenceConvection/">Turbulence Convection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Balance Laws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../BalanceLaws/BalanceLaws/">Balance Laws</a></li><li><a class="tocitem" href="../../../BalanceLaws/Problems/">Problems</a></li></ul></li><li><a class="tocitem" href="../../../Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-5-9" type="checkbox"/><label class="tocitem" for="menuitem-5-9"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Diagnostics/Diagnostics/">Diagnostics groups</a></li><li><a class="tocitem" href="../../../Diagnostics/StateCheck/">State Check</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-10" type="checkbox"/><label class="tocitem" for="menuitem-5-10"><span class="docs-label">Input/Output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-11" type="checkbox" checked/><label class="tocitem" for="menuitem-5-11"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../SystemSolvers/SystemSolvers/">SystemSolvers</a></li><li class="is-active"><a class="tocitem" href>ODESolvers</a><ul class="internal"><li><a class="tocitem" href="#Low-Storage-Runge-Kutta-methods"><span>Low Storage Runge Kutta methods</span></a></li><li><a class="tocitem" href="#Low-Storage-(3N)-Runge-Kutta-methods"><span>Low Storage (3N) Runge Kutta methods</span></a></li><li><a class="tocitem" href="#Strong-Stability-Preserving-RungeKutta-methods"><span>Strong Stability Preserving RungeKutta methods</span></a></li><li><a class="tocitem" href="#Additive-Runge-Kutta-methods"><span>Additive Runge Kutta methods</span></a></li><li><a class="tocitem" href="#Multi-rate-Runge-Kutta-Methods"><span>Multi-rate Runge Kutta Methods</span></a></li><li><a class="tocitem" href="#Multi-rate-Infinitesimal-Step-Methods"><span>Multi-rate Infinitesimal Step Methods</span></a></li><li><a class="tocitem" href="#Split-explicit-methods"><span>Split-explicit methods</span></a></li><li><a class="tocitem" href="#GARK-methods"><span>GARK methods</span></a></li><li><a class="tocitem" href="#Euler-methods"><span>Euler methods</span></a></li><li><a class="tocitem" href="#Differential-Equations"><span>Differential Equations</span></a></li><li><a class="tocitem" href="#ODE-Solvers"><span>ODE Solvers</span></a></li><li><a class="tocitem" href="#Generic-Callbacks"><span>Generic Callbacks</span></a></li></ul></li><li><a class="tocitem" href="../../DGMethods/DGMethods/">DG Methods</a></li><li><a class="tocitem" href="../../DGMethods/Courant/">Courant</a></li><li><a class="tocitem" href="../../DGMethods/NumericalFluxes/">Numerical Fluxes</a></li><li><a class="tocitem" href="../../DGMethods/FVReconstructions/">Finite Volume Reconstructions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-12" type="checkbox"/><label class="tocitem" for="menuitem-5-12"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Utilities/VariableTemplates/">Variable Templates</a></li><li><a class="tocitem" href="../../../Utilities/SingleStackUtils/">Single Stack Utilities</a></li><li><a class="tocitem" href="../../../Utilities/TicToc/">Tic Toc</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Theory/Common/SurfaceFluxes/">SurfaceFluxes</a></li><li><a class="tocitem" href="../../../../Theory/Common/Turbulence/">Turbulence Closures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Theory/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../../Theory/Atmos/EDMF_plots/">EDMF Model</a></li><li><a class="tocitem" href="../../../../Theory/Atmos/Microphysics_0M/">Microphysics_0M</a></li><li><a class="tocitem" href="../../../../Theory/Atmos/Microphysics/">Microphysics</a></li><li><a class="tocitem" href="../../../../Theory/Atmos/EDMFEquations/">EDMF equations</a></li><li><a class="tocitem" href="../../../../Theory/Atmos/Model/tracers/">Tracers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../DevDocs/CodeStyle/">Coding style</a></li><li><a class="tocitem" href="../../../../DevDocs/AcceptableUnicode/">Acceptable Unicode</a></li><li><a class="tocitem" href="../../../../DevDocs/ModelVariableList/">Model variable list</a></li><li><a class="tocitem" href="../../../../DevDocs/ModelOutput/">Model output</a></li><li><a class="tocitem" href="../../../../DevDocs/DiagnosticVariableList/">Diagnostic variable list</a></li><li><a class="tocitem" href="../../../../DevDocs/SystemImage/">Custom System Image</a></li></ul></li><li><a class="tocitem" href="../../../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">APIs</a></li><li><a class="is-disabled">Numerics</a></li><li class="is-active"><a href>ODESolvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ODESolvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimateMachine.jl/blob/master/docs/src/APIs/Numerics/ODESolvers/ODESolvers.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ODESolvers-docs"><a class="docs-heading-anchor" href="#ODESolvers-docs">ODESolvers</a><a id="ODESolvers-docs-1"></a><a class="docs-heading-anchor-permalink" href="#ODESolvers-docs" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers" href="#ClimateMachine.ODESolvers"><code>ClimateMachine.ODESolvers</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">ODESolvers</code></pre><p>Ordinary differential equation solvers</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/ODESolvers.jl#L1-L5">source</a></section></article><h2 id="Low-Storage-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Low-Storage-Runge-Kutta-methods">Low Storage Runge Kutta methods</a><a id="Low-Storage-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Storage-Runge-Kutta-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LowStorageRungeKutta2N" href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>ClimateMachine.ODESolvers.LowStorageRungeKutta2N</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LowStorageRungeKutta2N(f, RKA, RKB, RKC, Q; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds a low-storage Runge-Kutta scheme using 2N storage based on the provided <code>RKA</code>, <code>RKB</code> and <code>RKC</code> coefficient arrays.</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.LSRK54CarpenterKennedy"><code>LSRK54CarpenterKennedy</code></a></li><li><a href="#ClimateMachine.ODESolvers.LSRK144NiegemannDiehlBusch"><code>LSRK144NiegemannDiehlBusch</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKuttaMethod.jl#L5-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LSRK54CarpenterKennedy" href="#ClimateMachine.ODESolvers.LSRK54CarpenterKennedy"><code>ClimateMachine.ODESolvers.LSRK54CarpenterKennedy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">LSRK54CarpenterKennedy(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>LowStorageRungeKutta2N</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the fourth-order, low-storage, Runge–Kutta scheme of Carpenter and Kennedy (1994) (in their notation (5,4) 2N-Storage RK scheme).</p><p><strong>References</strong></p><pre><code class="language-none">@TECHREPORT{CarpenterKennedy1994,
  author = {M.~H. Carpenter and C.~A. Kennedy},
  title = {Fourth-order {2N-storage} {Runge-Kutta} schemes},
  institution = {National Aeronautics and Space Administration},
  year = {1994},
  number = {NASA TM-109112},
  address = {Langley Research Center, Hampton, VA},
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKuttaMethod.jl#L265-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LSRK144NiegemannDiehlBusch" href="#ClimateMachine.ODESolvers.LSRK144NiegemannDiehlBusch"><code>ClimateMachine.ODESolvers.LSRK144NiegemannDiehlBusch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">LSRK144NiegemannDiehlBusch((f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>LowStorageRungeKutta2N</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the fourth-order, 14-stage, low-storage, Runge–Kutta scheme of Niegemann, Diehl, and Busch (2012) with optimized stability region</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Niegemann2012">Jens Niegemann , Richard Diehl , Kurt Busch  (2012)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKuttaMethod.jl#L329-L348">source</a></section></article><h2 id="Low-Storage-(3N)-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Low-Storage-(3N)-Runge-Kutta-methods">Low Storage (3N) Runge Kutta methods</a><a id="Low-Storage-(3N)-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Low-Storage-(3N)-Runge-Kutta-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LowStorageRungeKutta3N" href="#ClimateMachine.ODESolvers.LowStorageRungeKutta3N"><code>ClimateMachine.ODESolvers.LowStorageRungeKutta3N</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LowStorageRungeKutta3N(f, RKA, RKB, RKC, RKW, Q; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds a low-storage Runge–Kutta scheme using 3N storage based on the provided <code>RKA</code>, <code>RKB</code> and <code>RKC</code> coefficient arrays.  <code>RKC</code> (vector of length the number of stages <code>ns</code>) set nodal points position;  <code>RKA</code> and <code>RKB</code> (size: ns x 2) set weight for tendency and stage-state;  <code>RKW</code> (unused) provides RK weight (last row in Butcher&#39;s tableau).</p><p>The 3-N storage formulation from Fyfe (1966) is applicable to any 4-stage, fourth-order RK scheme. It is implemented here as:</p><p class="math-container">\[\hspace{-20mm} for ~~ j ~~ in ~ [1:ns]: \hspace{10mm}
  t_j = t^n + \Delta t ~ rkC_j\]</p><p class="math-container">\[  dQ_j = dQ^*_j + f(Q_j,t_j)\]</p><p class="math-container">\[  Q_{j+1} = Q_{j} + \Delta t \{ rkB_{j,1} ~ dQ_j + rkB_{j,2} ~ dR_j \}\]</p><p class="math-container">\[  dR_{j+1} = dR_j + rkA_{j+1,2} ~ dQ_j\]</p><p class="math-container">\[  dQ^*_{j+1} = rkA_{j+1,1} ~ dQ_j\]</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.LS3NRK44Classic"><code>LS3NRK44Classic</code></a></li><li><a href="#ClimateMachine.ODESolvers.LS3NRK33Heuns"><code>LS3NRK33Heuns</code></a></li></ul><p><strong>References</strong></p><pre><code class="language-none">@article{Fyfe1966,
   title = {Economical Evaluation of Runge-Kutta Formulae},
   author = {Fyfe, David J.},
   journal = {Mathematics of Computation},
   volume = {20},
   pages = {392--398},
   year = {1966}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKutta3NMethod.jl#L4-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LS3NRK44Classic" href="#ClimateMachine.ODESolvers.LS3NRK44Classic"><code>ClimateMachine.ODESolvers.LS3NRK44Classic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">LS3NRK44Classic(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta3N"><code>LowStorageRungeKutta3N</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the classic 4-stage, fourth-order Runge–Kutta scheme in the low-storage implementation of Blum (1962)</p><p><strong>References</strong></p><pre><code class="language-none">@article {Blum1962,
   title = {A Modification of the Runge-Kutta Fourth-Order Method}
   author = {Blum, E. K.},
   journal = {Mathematics of Computation},
   volume = {16},
   pages = {176-187},
   year = {1962}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKutta3NMethod.jl#L228-L254">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LS3NRK33Heuns" href="#ClimateMachine.ODESolvers.LS3NRK33Heuns"><code>ClimateMachine.ODESolvers.LS3NRK33Heuns</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">LS3NRK33Heuns(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta3N"><code>LowStorageRungeKutta3N</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This method uses the 3-stage, third-order Heun&#39;s Runge–Kutta scheme.</p><p><strong>References</strong></p><pre><code class="language-none">@article {Heun1900,
   title = {Neue Methoden zur approximativen Integration der
   Differentialgleichungen einer unabh&quot;{a}ngigen Ver&quot;{a}nderlichen}
   author = {Heun, Karl},
   journal = {Z. Math. Phys},
   volume = {45},
   pages = {23--38},
   year = {1900}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKutta3NMethod.jl#L280-L306">source</a></section></article><h2 id="Strong-Stability-Preserving-RungeKutta-methods"><a class="docs-heading-anchor" href="#Strong-Stability-Preserving-RungeKutta-methods">Strong Stability Preserving RungeKutta methods</a><a id="Strong-Stability-Preserving-RungeKutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Strong-Stability-Preserving-RungeKutta-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta" href="#ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta"><code>ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">StrongStabilityPreservingRungeKutta(f, RKA, RKB, RKC, Q; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds a strong-stability-preserving Runge–Kutta scheme based on the provided <code>RKA</code>, <code>RKB</code> and <code>RKC</code> coefficient arrays.</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.SSPRK33ShuOsher"><code>SSPRK33ShuOsher</code></a></li><li><a href="#ClimateMachine.ODESolvers.SSPRK34SpiteriRuuth"><code>SSPRK34SpiteriRuuth</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/StrongStabilityPreservingRungeKuttaMethod.jl#L4-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.SSPRK33ShuOsher" href="#ClimateMachine.ODESolvers.SSPRK33ShuOsher"><code>ClimateMachine.ODESolvers.SSPRK33ShuOsher</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SSPRK33ShuOsher(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta"><code>StrongStabilityPreservingRungeKutta</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the third-order, 3-stage, strong-stability-preserving, Runge–Kutta scheme of Shu and Osher (1988)</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Shu1988">Chi-Wang Shu , Stanley Osher  (1988)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/StrongStabilityPreservingRungeKuttaMethod.jl#L243-L262">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.SSPRK34SpiteriRuuth" href="#ClimateMachine.ODESolvers.SSPRK34SpiteriRuuth"><code>ClimateMachine.ODESolvers.SSPRK34SpiteriRuuth</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SSPRK34SpiteriRuuth(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta"><code>StrongStabilityPreservingRungeKutta</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the third-order, 4-stage, strong-stability-preserving, Runge–Kutta scheme of Spiteri and Ruuth (1988)</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Spiteri2002">Raymond J Spiteri , Steven J Ruuth  (2002)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/StrongStabilityPreservingRungeKuttaMethod.jl#L272-L291">source</a></section></article><h2 id="Additive-Runge-Kutta-methods"><a class="docs-heading-anchor" href="#Additive-Runge-Kutta-methods">Additive Runge Kutta methods</a><a id="Additive-Runge-Kutta-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Additive-Runge-Kutta-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.AdditiveRungeKutta" href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>ClimateMachine.ODESolvers.AdditiveRungeKutta</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AdditiveRungeKutta(f, l, backward_euler_solver, RKAe, RKAi, RKB, RKC, Q;
                   split_explicit_implicit, variant, dt, t0 = 0)</code></pre><p>This is a time stepping object for implicit-explicit time stepping of a decomposed differential equation. When <code>split_explicit_implicit == false</code> the equation is assumed to be decomposed as</p><p class="math-container">\[  \dot{Q} = [l(Q, t)] + [f(Q, t) - l(Q, t)]\]</p><p>where <code>Q</code> is the state, <code>f</code> is the full tendency and <code>l</code> is the chosen implicit operator. When <code>split_explicit_implicit == true</code> the assumed decomposition is</p><p class="math-container">\[  \dot{Q} = [l(Q, t)] + [f(Q, t)]\]</p><p>where <code>f</code> is now only the nonlinear tendency. For both decompositions the implicit operator <code>l</code> is integrated implicitly whereas the remaining part is integrated explicitly. Other arguments are the required time step size <code>dt</code> and the optional initial time <code>t0</code>. The resulting backward Euler type systems are solved using the provided <code>backward_euler_solver</code>. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds an additive Runge–Kutta scheme based on the provided <code>RKAe</code>, <code>RKAi</code>, <code>RKB</code> and <code>RKC</code> coefficient arrays.  Additionally <code>variant</code> specifies which of the analytically equivalent but numerically different formulations of the scheme is used.</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.ARK1ForwardBackwardEuler"><code>ARK1ForwardBackwardEuler</code></a></li><li><a href="#ClimateMachine.ODESolvers.ARK2ImplicitExplicitMidpoint"><code>ARK2ImplicitExplicitMidpoint</code></a></li><li><a href="#ClimateMachine.ODESolvers.ARK2GiraldoKellyConstantinescu"><code>ARK2GiraldoKellyConstantinescu</code></a></li><li><a href="#ClimateMachine.ODESolvers.ARK548L2SA2KennedyCarpenter"><code>ARK548L2SA2KennedyCarpenter</code></a></li><li><a href="#ClimateMachine.ODESolvers.ARK437L2SA1KennedyCarpenter"><code>ARK437L2SA1KennedyCarpenter</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L24-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.ARK1ForwardBackwardEuler" href="#ClimateMachine.ODESolvers.ARK1ForwardBackwardEuler"><code>ClimateMachine.ODESolvers.ARK1ForwardBackwardEuler</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ARK1ForwardBackwardEuler(f, l, backward_euler_solver, Q; dt, t0,
                         split_explicit_implicit, variant)</code></pre><p>This function returns an <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> time stepping object, see the documentation of <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> for arguments definitions. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses a first-order-accurate two-stage additive Runge–Kutta scheme by combining a forward Euler explicit step with a backward Euler implicit correction.</p><p><strong>References</strong></p><pre><code class="language-none">@article{Ascher1997,
  title = {Implicit-explicit Runge-Kutta methods for time-dependent
           partial differential equations},
  author = {Uri M. Ascher and Steven J. Ruuth and Raymond J. Spiteri},
  volume = {25},
  number = {2-3},
  pages = {151--167},
  year = {1997},
  journal = {Applied Numerical Mathematics},
  publisher = {Elsevier {BV}}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L600-L624">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.ARK2ImplicitExplicitMidpoint" href="#ClimateMachine.ODESolvers.ARK2ImplicitExplicitMidpoint"><code>ClimateMachine.ODESolvers.ARK2ImplicitExplicitMidpoint</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ARK2ImplicitExplicitMidpoint(f, l, backward_euler_solver, Q; dt, t0,
                             split_explicit_implicit, variant)</code></pre><p>This function returns an <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> time stepping object, see the documentation of <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> for arguments definitions. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses a second-order-accurate two-stage additive Runge–Kutta scheme by combining the implicit and explicit midpoint methods.</p><p><strong>References</strong></p><pre><code class="language-none">@article{Ascher1997,
  title = {Implicit-explicit Runge-Kutta methods for time-dependent
           partial differential equations},
  author = {Uri M. Ascher and Steven J. Ruuth and Raymond J. Spiteri},
  volume = {25},
  number = {2-3},
  pages = {151--167},
  year = {1997},
  journal = {Applied Numerical Mathematics},
  publisher = {Elsevier {BV}}
}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L673-L696">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.ARK2GiraldoKellyConstantinescu" href="#ClimateMachine.ODESolvers.ARK2GiraldoKellyConstantinescu"><code>ClimateMachine.ODESolvers.ARK2GiraldoKellyConstantinescu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ARK2GiraldoKellyConstantinescu(f, l, backward_euler_solver, Q; dt, t0,
                               split_explicit_implicit, variant, paperversion)</code></pre><p>This function returns an <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> time stepping object, see the documentation of <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> for arguments definitions. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p><code>paperversion=true</code> uses the coefficients from the paper, <code>paperversion=false</code> uses coefficients that make the scheme (much) more stable but less accurate</p><p>This uses the second-order-accurate 3-stage additive Runge–Kutta scheme of Giraldo, Kelly and Constantinescu (2013).</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Giraldo2013">Francis X Giraldo , James F Kelly , Emil M Constantinescu  (2013)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L745-L761">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.ARK548L2SA2KennedyCarpenter" href="#ClimateMachine.ODESolvers.ARK548L2SA2KennedyCarpenter"><code>ClimateMachine.ODESolvers.ARK548L2SA2KennedyCarpenter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ARK548L2SA2KennedyCarpenter(f, l, backward_euler_solver, Q; dt, t0,
                            split_explicit_implicit, variant)</code></pre><p>This function returns an <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> time stepping object, see the documentation of <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> for arguments definitions. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the fifth-order-accurate 8-stage additive Runge–Kutta scheme of Kennedy and Carpenter (2013).</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Kennedy2019">Christopher A Kennedy , Mark H Carpenter  (2019)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L815-L828">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.ARK437L2SA1KennedyCarpenter" href="#ClimateMachine.ODESolvers.ARK437L2SA1KennedyCarpenter"><code>ClimateMachine.ODESolvers.ARK437L2SA1KennedyCarpenter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ARK437L2SA1KennedyCarpenter(f, l, backward_euler_solver, Q; dt, t0,
                            split_explicit_implicit, variant)</code></pre><p>This function returns an <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> time stepping object, see the documentation of <a href="#ClimateMachine.ODESolvers.AdditiveRungeKutta"><code>AdditiveRungeKutta</code></a> for arguments definitions. This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the fourth-order-accurate 7-stage additive Runge–Kutta scheme of Kennedy and Carpenter (2013).</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Kennedy2019">Christopher A Kennedy , Mark H Carpenter  (2019)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/AdditiveRungeKuttaMethod.jl#L959-L972">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.SSPRK22Ralstons" href="#ClimateMachine.ODESolvers.SSPRK22Ralstons"><code>ClimateMachine.ODESolvers.SSPRK22Ralstons</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SSPRK22Ralstons(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta"><code>StrongStabilityPreservingRungeKutta</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the second-order, 2-stage, strong-stability-preserving, Runge–Kutta scheme of Shu and Osher (1988) (also known as Ralstons&#39;s method.) Exact choice of coefficients from wikipedia page for Heun&#39;s method :)</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Shu1988">Chi-Wang Shu , Stanley Osher  (1988)</a></li><li><a href="../../../../References/#Ralston1962">Anthony Ralston  (1962)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/StrongStabilityPreservingRungeKuttaMethod.jl#L212-L233">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.SSPRK22Heuns" href="#ClimateMachine.ODESolvers.SSPRK22Heuns"><code>ClimateMachine.ODESolvers.SSPRK22Heuns</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">SSPRK22Heuns(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.StrongStabilityPreservingRungeKutta"><code>StrongStabilityPreservingRungeKutta</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This uses the second-order, 2-stage, strong-stability-preserving, Runge–Kutta scheme of Shu and Osher (1988) (also known as Heun&#39;s method.) Exact choice of coefficients from wikipedia page for Heun&#39;s method :)</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Shu1988">Chi-Wang Shu , Stanley Osher  (1988)</a></li><li><a href="../../../../References/#Heun1900">Karl Heun  (1900)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/StrongStabilityPreservingRungeKuttaMethod.jl#L181-L202">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LSRKEulerMethod" href="#ClimateMachine.ODESolvers.LSRKEulerMethod"><code>ClimateMachine.ODESolvers.LSRKEulerMethod</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">LSRKEulerMethod(f, Q; dt, t0 = 0)</code></pre><p>This function returns a <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>LowStorageRungeKutta2N</code></a> time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This method uses the LSRK2N framework to implement a simple Eulerian forward time stepping scheme for the use of debugging.</p><p><strong>References</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/LowStorageRungeKuttaMethod.jl#L228-L246">source</a></section></article><h2 id="Multi-rate-Runge-Kutta-Methods"><a class="docs-heading-anchor" href="#Multi-rate-Runge-Kutta-Methods">Multi-rate Runge Kutta Methods</a><a id="Multi-rate-Runge-Kutta-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-rate-Runge-Kutta-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MultirateRungeKutta" href="#ClimateMachine.ODESolvers.MultirateRungeKutta"><code>ClimateMachine.ODESolvers.MultirateRungeKutta</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MultirateRungeKutta(slow_solver, fast_solver; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f_fast(Q, t) + f_slow(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds a multirate Runge-Kutta scheme using two different RK solvers. This is based on</p><p>Currently only the low storage RK methods can be used as slow solvers</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Schlegel2012">M Schlegel , O Knoth , M Arnold , R Wolke  (2012)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateRungeKuttaMethod.jl#L6-L26">source</a></section></article><h2 id="Multi-rate-Infinitesimal-Step-Methods"><a class="docs-heading-anchor" href="#Multi-rate-Infinitesimal-Step-Methods">Multi-rate Infinitesimal Step Methods</a><a id="Multi-rate-Infinitesimal-Step-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-rate-Infinitesimal-Step-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.TimeScaledRHS" href="#ClimateMachine.ODESolvers.TimeScaledRHS"><code>ClimateMachine.ODESolvers.TimeScaledRHS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TimeScaledRHS(a, b, rhs!)</code></pre><p>When evaluate at time <code>t</code>, evaluates <code>rhs!</code> at time <code>a + bt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalStepMethod.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MultirateInfinitesimalStep" href="#ClimateMachine.ODESolvers.MultirateInfinitesimalStep"><code>ClimateMachine.ODESolvers.MultirateInfinitesimalStep</code></a> — <span class="docstring-category">Type</span></header><section><div><p>MultirateInfinitesimalStep(slowrhs!, fastrhs!, fastmethod,                            α, β, γ,                            Q::AT; dt=0, t0=0) where {AT&lt;:AbstractArray}</p><p>This is a time stepping object for explicitly time stepping the partitioned differential equation given by right-hand-side functions <code>f_fast</code> and <code>f_slow</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f_fast(Q, t) + f_slow(Q, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>The constructor builds a multirate infinitesimal step Runge-Kutta scheme based on the provided <code>α</code>, <code>β</code> and <code>γ</code> tableaux and <code>fastmethod</code> for solving the fast modes.</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#KnothWensch2014">Oswald Knoth , Joerg Wensch  (2014)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalStepMethod.jl#L59-L80">source</a></section></article><h2 id="Split-explicit-methods"><a class="docs-heading-anchor" href="#Split-explicit-methods">Split-explicit methods</a><a id="Split-explicit-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Split-explicit-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.SplitExplicitSolver" href="#ClimateMachine.ODESolvers.SplitExplicitSolver"><code>ClimateMachine.ODESolvers.SplitExplicitSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SplitExplicitSolver(slow_solver, fast_solver; dt, t0 = 0, coupled = true)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q_fast} = f_fast(Q_fast, Q_slow, t)
  \dot{Q_slow} = f_slow(Q_slow, Q_fast, t)\]</p><p>with the required time step size <code>dt</code> and optional initial time <code>t0</code>.  This time stepping object is intended to be passed to the <code>solve!</code> command.</p><p>This method performs an operator splitting to timestep the vertical average of the model at a faster rate than the full model. This results in a first- order time stepper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/SplitExplicitMethod.jl#L11-L29">source</a></section></article><h2 id="GARK-methods"><a class="docs-heading-anchor" href="#GARK-methods">GARK methods</a><a id="GARK-methods-1"></a><a class="docs-heading-anchor-permalink" href="#GARK-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKESDIRK46aSandu" href="#ClimateMachine.ODESolvers.MRIGARKESDIRK46aSandu"><code>ClimateMachine.ODESolvers.MRIGARKESDIRK46aSandu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKESDIRK46aSandu(f!, fastsolver, Q; dt, t0=0)</code></pre><p>The 4th order, 6 stage decoupled implicit scheme from Sandu (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L310-L314">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKIRK21aSandu" href="#ClimateMachine.ODESolvers.MRIGARKIRK21aSandu"><code>ClimateMachine.ODESolvers.MRIGARKIRK21aSandu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKIRK21aSandu(f!, fastsolver, Q; dt, t0 = 0)</code></pre><p>The 2rd order, 2 stage implicit scheme from Sandu (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L239-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKESDIRK24LSA" href="#ClimateMachine.ODESolvers.MRIGARKESDIRK24LSA"><code>ClimateMachine.ODESolvers.MRIGARKESDIRK24LSA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKESDIRK24LSA(f!,
                   fastsolver,
                   Q;
                   dt,
                   t0 = 0,
                   γ = 0.2,
                   c3 = (2γ + 1) / 2,
                   a32 = 0.2,
                   α = -0.1,
                   β1 = c3 / 10,
                   β2 = c3 / 10,
                   )</code></pre><p>A 2nd order, 4 stage decoupled implicit scheme. It is based on an L-Stable, stiffly-accurate ESDIRK.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L436-L452">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKESDIRK34aSandu" href="#ClimateMachine.ODESolvers.MRIGARKESDIRK34aSandu"><code>ClimateMachine.ODESolvers.MRIGARKESDIRK34aSandu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKESDIRK34aSandu(f!, fastsolver, Q; dt, t0=0)</code></pre><p>The 3rd order, 4 stage decoupled implicit scheme from Sandu (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L269-L273">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKERK45aSandu" href="#ClimateMachine.ODESolvers.MRIGARKERK45aSandu"><code>ClimateMachine.ODESolvers.MRIGARKERK45aSandu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKERK45aSandu(f!, fastsolver, Q; dt, t0 = 0)</code></pre><p>The 4th order, 5 stage scheme from Sandu (2019).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKExplicit.jl#L243-L247">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKExplicit" href="#ClimateMachine.ODESolvers.MRIGARKExplicit"><code>ClimateMachine.ODESolvers.MRIGARKExplicit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MRIGARKExplicit(f!, fastsolver, Γs, γ̂s, Q, Δt, t0)</code></pre><p>Construct an explicit MultiRate Infinitesimal General-structure Additive Runge–Kutta (MRI-GARK) scheme to solve</p><p class="math-container">\[    \dot{y} = f(y, t) + g(y, t)\]</p><p>where <code>f</code> is the slow tendency function and <code>g</code> is the fast tendency function; see Sandu (2019).</p><p>The fast tendency is integrated using the <code>fastsolver</code> and the slow tendency using the MRI-GARK scheme. Namely, at each stage the scheme solves</p><p class="math-container">\[               v(T_i) &amp;= Y_i \\
             \dot{v} &amp;= f(v, t) + \sum_{j=1}^{i} \bar{γ}_{ij}(t) R_j \\
    \bar{γ}_{ijk}(t) &amp;= \sum_{k=0}^{NΓ-1} γ_{ijk} τ(t)^k / Δc_s \\
                 τ(t) &amp;= (t - t_s) / Δt \\
              Y_{i+1} &amp;= v(T_i + c_s * Δt)\]</p><p>where <span>$Y_1 = y_n$</span> and <span>$y_{n+1} = Y_{Nstages+1}$</span>.</p><p>Here <span>$R_j = g(Y_j, t_0 + c_j * Δt)$</span> is the tendency for stage <span>$j$</span>, <span>$γ_{ijk}$</span> are the GARK coupling coefficients, <span>$NΓ$</span> is the number of sets of GARK coupling coefficients there are <span>$Δc_s = \sum_{j=1}^{Nstages} γ_{sj1} = c_{s+1} - c_s$</span> is the scaling increment between stage times. The ODE for <span>$v(t)$</span> is solved using the <code>fastsolver</code>.  Note that this form of the scheme is based on Definition 2.2 of Sandu (2019), but ODE for <span>$v(t)$</span> is written to go from <span>$t_s$</span> to <span>$T_i + c_s * Δt$</span> as opposed to <span>$0$</span> to <span>$1$</span>.</p><p>Currently only <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>LowStorageRungeKutta2N</code></a> schemes are supported for <code>fastsolver</code></p><p>The coefficients defined by <code>γ̂s</code> can be used for an embedded scheme (only the last stage is different).</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.MRIGARKERK33aSandu"><code>MRIGARKERK33aSandu</code></a></li><li><a href="#ClimateMachine.ODESolvers.MRIGARKERK45aSandu"><code>MRIGARKERK45aSandu</code></a></li></ul><p><strong>References</strong></p><ul><li><a href="../../../../References/#Sandu2019">Adrian Sandu  (2019)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKExplicit.jl#L40-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKESDIRK23LSA" href="#ClimateMachine.ODESolvers.MRIGARKESDIRK23LSA"><code>ClimateMachine.ODESolvers.MRIGARKESDIRK23LSA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKESDIRK23LSA(f!, fastsolver, Q; dt, t0 = 0, δ = 0</code></pre><p>A 2nd order, 3 stage decoupled implicit scheme. It is based on L-Stable, stiffly-accurate ESDIRK scheme of Bank et al (1985); see also Kennedy and Carpenter (2016).</p><p>The free parameter <code>δ</code> can take any values for accuracy.</p><p><strong>References</strong></p><ul><li><a href="../../../../References/#Bank1985">R. E. Bank , W. M. Coughran , W. Fichtner , E. H. Grosse , D. J. Rose , R. K. Smith  (1985)</a></li><li><a href="../../../../References/#KennedyCarpenter2016">C. A. Kennedy , M. H. Carpenter  (2016)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L370-L382">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKERK33aSandu" href="#ClimateMachine.ODESolvers.MRIGARKERK33aSandu"><code>ClimateMachine.ODESolvers.MRIGARKERK33aSandu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">MRIGARKERK33aSandu(f!, fastsolver, Q; dt, t0 = 0, δ = -1 // 2)</code></pre><p>The 3rd order, 3 stage scheme from Sandu (2019). The parameter <code>δ</code> defaults to the value suggested by Sandu, but can be varied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKExplicit.jl#L216-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.MRIGARKDecoupledImplicit" href="#ClimateMachine.ODESolvers.MRIGARKDecoupledImplicit"><code>ClimateMachine.ODESolvers.MRIGARKDecoupledImplicit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MRIGARKDecoupledImplicit(f!, backward_euler_solver, fastsolver, Γs, γ̂s, Q,
                         Δt, t0)</code></pre><p>Construct a decoupled implicit MultiRate Infinitesimal General-structure Additive Runge–Kutta (MRI-GARK) scheme to solve</p><p class="math-container">\[    \dot{y} = f(y, t) + g(y, t)\]</p><p>where <code>f</code> is the slow tendency function and <code>g</code> is the fast tendency function; see Sandu (2019).</p><p>The fast tendency is integrated using the <code>fastsolver</code> and the slow tendency using the MRI-GARK scheme. Since this is a decoupled, implicit MRI-GARK there is no implicit coupling between the fast and slow tendencies.</p><p>The <code>backward_euler_solver</code> should be of type <code>AbstractBackwardEulerSolver</code> or <code>LinearBackwardEulerSolver</code>, and is used to perform the backward Euler solves for <code>y</code> given the slow tendency function, namely</p><p class="math-container">\[   y = z + α f(y, t; p)\]</p><p>Currently only <a href="#ClimateMachine.ODESolvers.LowStorageRungeKutta2N"><code>LowStorageRungeKutta2N</code></a> schemes are supported for <code>fastsolver</code></p><p>The coefficients defined by <code>γ̂s</code> can be used for an embedded scheme (only the last stage is different).</p><p>The available concrete implementations are:</p><ul><li><a href="#ClimateMachine.ODESolvers.MRIGARKIRK21aSandu"><code>MRIGARKIRK21aSandu</code></a></li><li><a href="#ClimateMachine.ODESolvers.MRIGARKESDIRK34aSandu"><code>MRIGARKESDIRK34aSandu</code></a></li><li><a href="#ClimateMachine.ODESolvers.MRIGARKESDIRK46aSandu"><code>MRIGARKESDIRK46aSandu</code></a></li></ul><p><strong>References</strong></p><ul><li><a href="../../../../References/#Sandu2019">Adrian Sandu  (2019)</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/MultirateInfinitesimalGARKDecoupledImplicit.jl#L8-L47">source</a></section></article><h2 id="Euler-methods"><a class="docs-heading-anchor" href="#Euler-methods">Euler methods</a><a id="Euler-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Euler-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.LinearBackwardEulerSolver" href="#ClimateMachine.ODESolvers.LinearBackwardEulerSolver"><code>ClimateMachine.ODESolvers.LinearBackwardEulerSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LinearBackwardEulerSolver(::AbstractSystemSolver; isadjustable = false)</code></pre><p>Helper type for specifying building a backward Euler solver with a linear solver.  If <code>isadjustable == true</code> then the solver can be updated with a new time step size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/BackwardEulerSolvers.jl#L84-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.AbstractBackwardEulerSolver" href="#ClimateMachine.ODESolvers.AbstractBackwardEulerSolver"><code>ClimateMachine.ODESolvers.AbstractBackwardEulerSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractBackwardEulerSolver</code></pre><p>An abstract backward Euler method</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/BackwardEulerSolvers.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.NonLinearBackwardEulerSolver" href="#ClimateMachine.ODESolvers.NonLinearBackwardEulerSolver"><code>ClimateMachine.ODESolvers.NonLinearBackwardEulerSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct NonLinearBackwardEulerSolver{NLS}
    nlsolver::NLS
    isadjustable::Bool
    preconditioner_update_freq::Int64
end</code></pre><p>Helper type for specifying building a nonlinear backward Euler solver with a nonlinear solver.</p><p><strong>Arguments</strong></p><ul><li><code>nlsolver</code>: iterative nonlinear solver, i.e., JacobianFreeNewtonKrylovSolver</li><li><code>isadjustable</code>: TODO not used, might use for updating preconditioner</li><li><code>preconditioner_update_freq</code>:  relavent to Jacobian free -1: no preconditioner;                            positive number, update every freq times</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/BackwardEulerSolvers.jl#L192-L207">source</a></section></article><h2 id="Differential-Equations"><a class="docs-heading-anchor" href="#Differential-Equations">Differential Equations</a><a id="Differential-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.DiffEqJLIMEXSolver" href="#ClimateMachine.ODESolvers.DiffEqJLIMEXSolver"><code>ClimateMachine.ODESolvers.DiffEqJLIMEXSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DiffEqJLSolver(f, RKA, RKB, RKC, Q; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f_I(Q, t) + f_E(Q, t)\]</p><p>via a DifferentialEquations.jl DEAlgorithm, which includes support for OrdinaryDiffEq.jl, Sundials.jl, and more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/DifferentialEquations.jl#L52-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.DiffEqJLSolver" href="#ClimateMachine.ODESolvers.DiffEqJLSolver"><code>ClimateMachine.ODESolvers.DiffEqJLSolver</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DiffEqJLSolver(f, RKA, RKB, RKC, Q; dt, t0 = 0)</code></pre><p>This is a time stepping object for explicitly time stepping the differential equation given by the right-hand-side function <code>f</code> with the state <code>Q</code>, i.e.,</p><p class="math-container">\[  \dot{Q} = f(Q, t)\]</p><p>via a DifferentialEquations.jl DEAlgorithm, which includes support for OrdinaryDiffEq.jl, Sundials.jl, and more.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/DifferentialEquations.jl#L6-L18">source</a></section></article><h2 id="ODE-Solvers"><a class="docs-heading-anchor" href="#ODE-Solvers">ODE Solvers</a><a id="ODE-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#ODE-Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.solve!" href="#ClimateMachine.ODESolvers.solve!"><code>ClimateMachine.ODESolvers.solve!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">solve!(Q, solver::AbstractODESolver; timeend,
       stopaftertimeend=true, numberofsteps, callbacks)</code></pre><p>Solves an ODE using the <code>solver</code> starting from a state <code>Q</code>. The state <code>Q</code> is updated inplace. The final time <code>timeend</code> or <code>numberofsteps</code> must be specified.</p><p>A series of optional callback functions can be specified using the tuple <code>callbacks</code>; see the <code>GenericCallbacks</code> module.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/ODESolvers.jl#L99-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.updatedt!" href="#ClimateMachine.ODESolvers.updatedt!"><code>ClimateMachine.ODESolvers.updatedt!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">updatedt!(solver::AbstractODESolver, dt)</code></pre><p>Change the time step size to <code>dt</code> for the ODE solver <code>solver</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/ODESolvers.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.gettime" href="#ClimateMachine.ODESolvers.gettime"><code>ClimateMachine.ODESolvers.gettime</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gettime(solver::AbstractODESolver)</code></pre><p>Returns the current simulation time of the ODE solver <code>solver</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/ODESolvers.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.ODESolvers.getsteps" href="#ClimateMachine.ODESolvers.getsteps"><code>ClimateMachine.ODESolvers.getsteps</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">getsteps(solver::AbstractODESolver)</code></pre><p>Returns the number of completed time steps of the ODE solver <code>solver</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/ODESolvers.jl#L33-L37">source</a></section></article><h2 id="Generic-Callbacks"><a class="docs-heading-anchor" href="#Generic-Callbacks">Generic Callbacks</a><a id="Generic-Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Generic-Callbacks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks" href="#ClimateMachine.GenericCallbacks"><code>ClimateMachine.GenericCallbacks</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">GenericCallbacks</code></pre><p>This module defines interfaces and wrappers for callbacks to be used with an <code>AbstractODESolver</code>.</p><p>A callback <code>cb</code> defines three methods:</p><ul><li><p><code>GenericCallbacks.init!(cb, solver, Q, param, t)</code>, to be called at solver initialization.</p></li><li><p><code>GenericCallbacks.call!(cb, solver, Q, param, t)</code>, to be called after each time step: the return value dictates what action should be taken:</p><ul><li><code>0</code> or <code>nothing</code>: continue time stepping as usual</li><li><code>1</code>: stop time stepping after all callbacks have been executed</li><li><code>2</code>: stop time stepping immediately</li></ul></li><li><p><code>GenericCallbacks.fini!(cb, solver, Q, param, t)</code>, to be called at solver finish.</p></li></ul><p>Additionally, <em>wrapper</em> callbacks can be used to execute the callbacks under certain conditions:</p><ul><li><a href="#ClimateMachine.GenericCallbacks.AtInit"><code>AtInit</code></a></li><li><a href="#ClimateMachine.GenericCallbacks.AtInitAndFini"><code>AtInitAndFini</code></a></li><li><a href="#ClimateMachine.GenericCallbacks.EveryXWallTimeSeconds"><code>EveryXWallTimeSeconds</code></a></li><li><a href="#ClimateMachine.GenericCallbacks.EveryXSimulationTime"><code>EveryXSimulationTime</code></a></li><li><a href="#ClimateMachine.GenericCallbacks.EveryXSimulationSteps"><code>EveryXSimulationSteps</code></a></li></ul><p>For convenience, the following objects can also be used as callbacks:</p><ul><li>A <code>Function</code> object <code>f</code>, <code>init!</code> and <code>fini!</code> are no-ops, and <code>call!</code> will call <code>f()</code>, and ignore the return value.</li><li>A <code>Tuple</code> object will call <code>init!</code>, <code>call!</code> and <code>fini!</code> on each element of the tuple.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L1-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks.AtInit" href="#ClimateMachine.GenericCallbacks.AtInit"><code>ClimateMachine.GenericCallbacks.AtInit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AtInit(callback) &lt;: AbstractCallback</code></pre><p>A wrapper callback to execute <code>callback</code> at initialization as well as after each interval.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L80-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks.AtInitAndFini" href="#ClimateMachine.GenericCallbacks.AtInitAndFini"><code>ClimateMachine.GenericCallbacks.AtInitAndFini</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AtInitAndFini(callback) &lt;: AbstractCallback</code></pre><p>A wrapper callback to execute <code>callback</code> at initialization and at finish as well as after each interval.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L100-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks.EveryXWallTimeSeconds" href="#ClimateMachine.GenericCallbacks.EveryXWallTimeSeconds"><code>ClimateMachine.GenericCallbacks.EveryXWallTimeSeconds</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">EveryXWallTimeSeconds(callback, Δtime, mpicomm)</code></pre><p>A wrapper callback to execute <code>callback</code> every <code>Δtime</code> wallclock time seconds. <code>mpicomm</code> is used to syncronize runtime across MPI ranks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L121-L126">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks.EveryXSimulationTime" href="#ClimateMachine.GenericCallbacks.EveryXSimulationTime"><code>ClimateMachine.GenericCallbacks.EveryXSimulationTime</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">EveryXSimulationTime(f, Δtime)</code></pre><p>A wrapper callback to execute <code>callback</code> every <code>time</code> simulation time seconds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L164-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimateMachine.GenericCallbacks.EveryXSimulationSteps" href="#ClimateMachine.GenericCallbacks.EveryXSimulationSteps"><code>ClimateMachine.GenericCallbacks.EveryXSimulationSteps</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">EveryXSimulationSteps(callback, Δsteps)</code></pre><p>A wrapper callback to execute <code>callback</code> every <code>nsteps</code> of the time stepper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimateMachine.jl/blob/ad340c53aeb964aeb949e4e146baaa4199b063b3/src/Numerics/ODESolvers/GenericCallbacks.jl#L200-L204">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../SystemSolvers/SystemSolvers/">« SystemSolvers</a><a class="docs-footer-nextpage" href="../../DGMethods/DGMethods/">DG Methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 22 December 2020 17:29">Tuesday 22 December 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

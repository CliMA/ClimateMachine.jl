<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydraulic Functions · ClimateMachine</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-191640394-1', 'auto');
ga('send', 'pageview', {'page': location.pathname + location.search + location.hash});
</script><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../../assets/documenter.js"></script><script src="../../../../../siteinfo.js"></script><script src="../../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../../"><img src="../../../../../assets/logo.svg" alt="ClimateMachine logo"/></a><div class="docs-package-name"><span class="docs-autofit">ClimateMachine</span></div><form class="docs-search" action="../../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Getting started</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../GettingStarted/Installation/">Installation</a></li><li><a class="tocitem" href="../../../../../GettingStarted/Terminology/">Terminology</a></li><li><a class="tocitem" href="../../../../../GettingStarted/RunningClimateMachine/">Running</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Defaults</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../GettingStarted/Atmos/">Atmosphere model configurations</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../TutorialList/">Home</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">BalanceLaws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../BalanceLaws/tendency_specification_layer/">Tendency specification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Atmos/heldsuarez/">Dry Idealized GCM (Held-Suarez)</a></li><li><a class="tocitem" href="../../../../Atmos/burgers_single_stack/">Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../../Atmos/burgers_single_stack_fvm/">Finite Volume Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../../Atmos/burgers_single_stack_bjfnk/">HEVI Single Element Stack Experiment (Burgers Equation)</a></li><li><a class="tocitem" href="../../../../Atmos/densitycurrent/">LES Experiment (Density Current)</a></li><li><a class="tocitem" href="../../../../Atmos/risingbubble/">LES Experiment (Rising Thermal Bubble)</a></li><li><a class="tocitem" href="../../../../Atmos/agnesi_hs_lin/">Linear Hydrostatic Mountain (Topography)</a></li><li><a class="tocitem" href="../../../../Atmos/agnesi_nh_lin/">Linear Non-Hydrostatic Mountain (Topography)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-4-1" type="checkbox"/><label class="tocitem" for="menuitem-3-4-1"><span class="docs-label">Heat</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Heat/heat_equation/">Heat Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-4-2"><span class="docs-label">Soil</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Hydraulic Functions</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Preliminary-setup"><span>Preliminary setup</span></a></li><li class="toplevel"><a class="tocitem" href="#Specifying-a-hydraulics-model"><span>Specifying a hydraulics model</span></a></li><li class="toplevel"><a class="tocitem" href="#Matric-Potential"><span>Matric Potential</span></a></li><li class="toplevel"><a class="tocitem" href="#Hydraulic-conductivity"><span>Hydraulic conductivity</span></a></li><li class="toplevel"><a class="tocitem" href="#Other-features"><span>Other features</span></a></li><li class="toplevel"><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../../Heat/bonan_heat_tutorial/">Soil Heat Equation</a></li><li><a class="tocitem" href="../equilibrium_test/">Richards Equation</a></li><li><a class="tocitem" href="../../Coupled/equilibrium_test/">Coupled Water and Heat</a></li><li><a class="tocitem" href="../../PhaseChange/freezing_front/">Phase Change I</a></li><li><a class="tocitem" href="../../PhaseChange/phase_change_analytic_test/">Phase Change II</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Ocean</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Ocean/geostrophic_adjustment/">One-dimensional geostrophic adjustment</a></li><li><a class="tocitem" href="../../../../Ocean/internal_wave/">Propagating mode-1 internal wave</a></li><li><a class="tocitem" href="../../../../Ocean/shear_instability/">Shear instability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-6-1" type="checkbox"/><label class="tocitem" for="menuitem-3-6-1"><span class="docs-label">System Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/SystemSolvers/cg/">Conjugate Gradient</a></li><li><a class="tocitem" href="../../../../Numerics/SystemSolvers/bgmres/">Batched Generalized Minimal Residual</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-2"><span class="docs-label">DG Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/DGMethods/showcase_filters/">Filters</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3"><span class="docs-label">Time-Stepping</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/TimeStepping/ts_intro/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-6-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-2"><span class="docs-label">Explicit Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/TimeStepping/explicit_lsrk/">Single-rate Explicit Timestepping</a></li><li><a class="tocitem" href="../../../../Numerics/TimeStepping/tutorial_risingbubble_config/">Rising Thermal Bubble Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-3"><span class="docs-label">Implicit-Explicit (IMEX) Additive Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/TimeStepping/imex_ark/">Implicit-Explicit (IMEX) Additively-Partitioned Runge-Kutta Timestepping</a></li><li><a class="tocitem" href="../../../../Numerics/TimeStepping/tutorial_acousticwave_config/">Acoustic Wave Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-4"><span class="docs-label">Multirate Runge-Kutta methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/TimeStepping/multirate_rk/">Multirate Runge-Kutta Timestepping</a></li><li><a class="tocitem" href="../../../../Numerics/TimeStepping/tutorial_risingbubble_config/">Rising Thermal Bubble Configuration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-6-3-5"><span class="docs-label">MIS methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Numerics/TimeStepping/mis/">Multirate Infinitesimal Step (MIS) Timestepping</a></li><li><a class="tocitem" href="../../../../Numerics/TimeStepping/tutorial_acousticwave_config/">Acoustic Wave Configuration</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-7-1" type="checkbox"/><label class="tocitem" for="menuitem-3-7-1"><span class="docs-label">Debug</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../Diagnostics/Debug/StateCheck/">State Statistics Regression</a></li></ul></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How-to-guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Balance Laws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../HowToGuides/BalanceLaws/how_to_make_a_balance_law/">How to make a balance law</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../HowToGuides/Atmos/AtmosReferenceState/">Reference profiles</a></li><li><a class="tocitem" href="../../../../../HowToGuides/Atmos/MoistureModelChoices/">Moisture model</a></li><li><a class="tocitem" href="../../../../../HowToGuides/Atmos/PrecipitationModelChoices/">Precipitation model</a></li><li><a class="tocitem" href="../../../../../HowToGuides/Atmos/MoistureAndPrecip/">How to create an experiment with moisture and precipitation</a></li></ul></li><li><span class="tocitem">Ocean</span></li><li><span class="tocitem">Land</span></li><li><input class="collapse-toggle" id="menuitem-4-5" type="checkbox"/><label class="tocitem" for="menuitem-4-5"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><span class="tocitem">Meshes</span></li><li><input class="collapse-toggle" id="menuitem-4-5-2" type="checkbox"/><label class="tocitem" for="menuitem-4-5-2"><span class="docs-label">ODE Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../HowToGuides/Numerics/ODESolvers/Timestepping/">Time-integration</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-5-3" type="checkbox"/><label class="tocitem" for="menuitem-4-5-3"><span class="docs-label">System Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../HowToGuides/Numerics/SystemSolvers/IterativeSolvers/">Iterative Solvers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-6" type="checkbox"/><label class="tocitem" for="menuitem-4-6"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../HowToGuides/Diagnostics/UsingDiagnostics/">Using Diagnostics</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/">Home</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Driver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Driver/">Top level interface</a></li><li><a class="tocitem" href="../../../../../APIs/Driver/Checkpoint/">Checkpoint</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-3" type="checkbox"/><label class="tocitem" for="menuitem-5-3"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Atmos/AtmosModel/">AtmosModel</a></li></ul></li><li><a class="tocitem" href="../../../../../APIs/Ocean/Ocean/">Ocean</a></li><li><input class="collapse-toggle" id="menuitem-5-5" type="checkbox"/><label class="tocitem" for="menuitem-5-5"><span class="docs-label">Land</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Land/LandModel/">Land Model</a></li><li><a class="tocitem" href="../../../../../APIs/Land/Runoff/">Runoff Parameterizations</a></li><li><a class="tocitem" href="../../../../../APIs/Land/SoilWaterParameterizations/">Soil Water Parameterizations</a></li><li><a class="tocitem" href="../../../../../APIs/Land/SoilHeatParameterizations/">Soil Heat Parameterizations</a></li><li><a class="tocitem" href="../../../../../APIs/Land/SurfaceFlow/">Surface Flow</a></li><li><a class="tocitem" href="../../../../../APIs/Land/RadiativeEnergyFlux/">Radiative Boundary Conditions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Common/Orientations/">Orientations</a></li><li><a class="tocitem" href="../../../../../APIs/Common/CartesianDomains/">Cartesian Domains</a></li><li><a class="tocitem" href="../../../../../APIs/Common/CartesianFields/">Cartesian Fields</a></li><li><a class="tocitem" href="../../../../../APIs/Common/Spectra/">Spectra</a></li><li><a class="tocitem" href="../../../../../APIs/Common/TurbulenceClosures/">Turbulence Closures</a></li><li><a class="tocitem" href="../../../../../APIs/Common/TurbulenceConvection/">Turbulence Convection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-7" type="checkbox"/><label class="tocitem" for="menuitem-5-7"><span class="docs-label">Balance Laws</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/BalanceLaws/BalanceLaws/">Balance Laws</a></li><li><a class="tocitem" href="../../../../../APIs/BalanceLaws/Problems/">Problems</a></li></ul></li><li><a class="tocitem" href="../../../../../APIs/Arrays/Arrays/">Arrays</a></li><li><input class="collapse-toggle" id="menuitem-5-9" type="checkbox"/><label class="tocitem" for="menuitem-5-9"><span class="docs-label">Diagnostics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Diagnostics/Diagnostics/">Diagnostics groups</a></li><li><a class="tocitem" href="../../../../../APIs/Diagnostics/DiagnosticsMachine/">DiagnosticsMachine</a></li><li><a class="tocitem" href="../../../../../APIs/Diagnostics/StdDiagnostics/">StdDiagnostics</a></li><li><a class="tocitem" href="../../../../../APIs/Diagnostics/StateCheck/">State Check</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-10" type="checkbox"/><label class="tocitem" for="menuitem-5-10"><span class="docs-label">Input/Output</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/InputOutput/">Input/Output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-11" type="checkbox"/><label class="tocitem" for="menuitem-5-11"><span class="docs-label">Numerics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Numerics/Meshes/Mesh/">Meshes</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/SystemSolvers/SystemSolvers/">SystemSolvers</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/ODESolvers/ODESolvers/">ODESolvers</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/DGMethods/DGMethods/">DG Methods</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/DGMethods/Courant/">Courant</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/DGMethods/NumericalFluxes/">Numerical Fluxes</a></li><li><a class="tocitem" href="../../../../../APIs/Numerics/DGMethods/FVReconstructions/">Finite Volume Reconstructions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-12" type="checkbox"/><label class="tocitem" for="menuitem-5-12"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../APIs/Utilities/VariableTemplates/">Variable Templates</a></li><li><a class="tocitem" href="../../../../../APIs/Utilities/SingleStackUtils/">Single Stack Utilities</a></li><li><a class="tocitem" href="../../../../../APIs/Utilities/TicToc/">Tic Toc</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../../../Contributing/">Contribution guide</a></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Theory</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-7-1" type="checkbox"/><label class="tocitem" for="menuitem-7-1"><span class="docs-label">Common</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../Theory/Common/Turbulence/">Turbulence Closures</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Atmos</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../Theory/Atmos/AtmosModel/">AtmosModel</a></li><li><a class="tocitem" href="../../../../../Theory/Atmos/EDMF_plots/">EDMF Model</a></li><li><a class="tocitem" href="../../../../../Theory/Atmos/Microphysics_0M/">Microphysics_0M</a></li><li><a class="tocitem" href="../../../../../Theory/Atmos/Microphysics_1M/">Microphysics_1M</a></li><li><a class="tocitem" href="../../../../../Theory/Atmos/EDMFEquations/">EDMF equations</a></li><li><a class="tocitem" href="../../../../../Theory/Atmos/Model/tracers/">Tracers</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../../../DevDocs/CodeStyle/">Coding style</a></li><li><a class="tocitem" href="../../../../../DevDocs/AcceptableUnicode/">Acceptable Unicode</a></li><li><a class="tocitem" href="../../../../../DevDocs/ModelVariableList/">Model variable list</a></li><li><a class="tocitem" href="../../../../../DevDocs/ModelOutput/">Model output</a></li><li><a class="tocitem" href="../../../../../DevDocs/DiagnosticVariableList/">Diagnostic variable list</a></li><li><a class="tocitem" href="../../../../../DevDocs/SystemImage/">Custom System Image</a></li></ul></li><li><a class="tocitem" href="../../../../../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Land</a></li><li><a class="is-disabled">Soil</a></li><li class="is-active"><a href>Hydraulic Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydraulic Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimateMachine.jl/../../../../../.." title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Hydraulic-functions"><a class="docs-heading-anchor" href="#Hydraulic-functions">Hydraulic functions</a><a id="Hydraulic-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Hydraulic-functions" title="Permalink"></a></h1><p>This tutorial shows how to specify the hydraulic functions used in Richard&#39;s equation. In particular, we show how to choose the formalism for matric potential and hydraulic conductivity, and how to make the hydraulic conductivity account for the presence of ice as well as the temperature dependence of the viscosity of liquid water.</p><h1 id="Preliminary-setup"><a class="docs-heading-anchor" href="#Preliminary-setup">Preliminary setup</a><a id="Preliminary-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Preliminary-setup" title="Permalink"></a></h1><p>External modules</p><pre><code class="language-julia">using Plots</code></pre><p>ClimateMachine modules</p><pre><code class="language-julia">using ClimateMachine
using ClimateMachine.Land
using ClimateMachine.Land.SoilWaterParameterizations

FT = Float32;</code></pre><h1 id="Specifying-a-hydraulics-model"><a class="docs-heading-anchor" href="#Specifying-a-hydraulics-model">Specifying a hydraulics model</a><a id="Specifying-a-hydraulics-model-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-a-hydraulics-model" title="Permalink"></a></h1><p>ClimateMachine&#39;s Land model allows the user to pick between two hydraulics models, that of van Genuchten <a href="../../../../../References/#vanGenuchten1980">M. Th. Genuchten  (1980)</a> or that of Brooks and Corey, see <a href="../../../../../References/#BrooksCorey1964">R. J. Brooks , A. T. Corey  (1964)</a> or <a href="../../../../../References/#Corey1977">A. T. Corey  (1977)</a>. The same model is consistently used for the matric potential and hydraulic conductivity.</p><p>The van Genuchten model requires two free parameters, <code>α</code> and <code>n</code>. A third parameter, <code>m</code>, is computed from <code>n</code>. Of these, only <code>α</code> carries units, of inverse meters. The Brooks and Corey model also uses two free parameters, <code>ψ_b</code>, the magnitude of the matric potential at saturation,  and a constant <code>M</code>. <code>ψ_b</code> carries units of meters. These parameter sets are stored in either the <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.vanGenuchten"><code>vanGenuchten</code></a> or the <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.BrooksCorey"><code>BrooksCorey</code></a> hydraulics model structures (more details below). These parameters are enough to compute the matric potential.</p><p>The hydraulic conductivity requires an additional parameter, <code>Ksat</code> (m/s), which is the hydraulic conductivity in saturated soil. This parameter is not stored in the hydraulics model, but rather as part of the <a href="../../../../../APIs/Land/LandModel/#ClimateMachine.Land.WaterParamFunctions"><code>WaterParamFunctions</code></a>, which stores other parameters needed for the soil water modeling.</p><p>Below we show how to create two concrete examples of these hydraulics models, for sandy loam (<a href="../../../../../References/#Bonan19a">G. Bonan  (2019)</a>). Note that the parameters chosen are a function of soil type, and that the parameters are converted to type <code>FT</code> internally.</p><pre><code class="language-julia">vg_α = 7.5 # m^-1
vg_n = 1.89
hydraulics = vanGenuchten(FT; α = vg_α, n = vg_n);

ψ_sat = 0.218 # m
Mval = 0.2041
hydraulics_bc = BrooksCorey(FT; ψb = ψ_sat, m = Mval);</code></pre><h1 id="Matric-Potential"><a class="docs-heading-anchor" href="#Matric-Potential">Matric Potential</a><a id="Matric-Potential-1"></a><a class="docs-heading-anchor-permalink" href="#Matric-Potential" title="Permalink"></a></h1><p>The matric potential <code>ψ</code> reflects the negative pressure of water in unsaturated soil. The negative pressure (suction) of water arises because of adhesive forces between water and soil.</p><p>The van Genuchten expression for matric potential is <span>$ψ = -\frac{1}{α} S_l^{-1/(nm)}\times (1-S_l^{1/m})^{1/n},$</span></p><p>and the Brooks and Corey expression is <span>$ψ = -ψ_b S_l^{-M}.$</span></p><p>Here <code>S_l</code> is the effective saturation of liquid water, <code>θ_l/ν</code>, where <code>ν</code> is porosity of the soil. We generally neglect the residual pore space in the CliMA model, but the user can set the parameter in the <a href="../../../../../APIs/Land/LandModel/#ClimateMachine.Land.WaterParamFunctions"><code>WaterParamFunctions</code></a> structure if it is desired.</p><p>In the CliMA code, we use <a href="https://en.wikipedia.org/wiki/Multiple_dispatch">multiple dispatch</a>. With multiple dispatch, a function can have many ways of executing (called methods), depending on the <em>type</em> of the variables passed in. A simple example of multiple dispatch is the division operation. Integer division takes two numbers as input, and returns an integer - ignoring the decimal. Float division takes two numbers as input, and returns a floating point number, including the decimal. In Julia, we might write these as:</p><pre><code class="language-julia">function division(a::Int, b::Int)
     return floor(Int, a/b)
end</code></pre><pre><code class="language-julia">function division(a::Float64, b::Float64)
     return a/b
end</code></pre><p>We can see that <code>division</code> is now a function with two methods.</p><pre><code class="language-julia">julia&gt; division
division (generic function with 2 methods)</code></pre><p>Now, using the same function signature, we can carry out integer division or floating point division, depending on the types of the arguments:</p><pre><code class="language-julia">julia&gt; division(1,2)
0

julia&gt; division(1.0,2.0)
0.5</code></pre><p>Here are more pertinent examples: Based on our choice of <code>FT = Float32</code>,</p><pre><code class="language-julia">julia&gt; typeof(hydraulics)
vanGenuchten{Float32,Float32,Float32,Float32}</code></pre><p>but meanwhile,</p><pre><code class="language-julia">julia&gt; typeof(hydraulics_bc)
BrooksCorey{Float32,Float32,Float32}</code></pre><p>The function <code>matric_potential</code> will execute different methods depending on if we pass a hydraulics model of type <code>vanGenuchten</code> or <code>BrooksCorey</code>. In both cases, it will return the correct value for <code>ψ</code>.</p><p>Let&#39;s plot the matric potential as a function of the effective saturation <code>S_l = θ_l/ν</code>, which can range from zero to one.</p><pre><code class="language-julia">S_l = FT.(0.01:0.01:0.99)
ψ = matric_potential.(Ref(hydraulics), S_l)
ψ_bc = matric_potential.(Ref(hydraulics_bc), S_l)
plot(
    S_l,
    log10.(-ψ),
    xlabel = &quot;effective saturation&quot;,
    ylabel = &quot;Log10(|ψ|)&quot;,
    label = &quot;van Genuchten&quot;,
)
plot!(S_l, log10.(-ψ_bc), label = &quot;Brooks and Corey&quot;)
savefig(&quot;bc_vg_matric_potential.png&quot;)</code></pre><p><img src="../bc_vg_matric_potential.png" alt/></p><p>The steep slope in <code>ψ</code> near saturated and completely dry soil are part of the reason why Richard&#39;s equation is such a challenging numerical problem.</p><h1 id="Hydraulic-conductivity"><a class="docs-heading-anchor" href="#Hydraulic-conductivity">Hydraulic conductivity</a><a id="Hydraulic-conductivity-1"></a><a class="docs-heading-anchor-permalink" href="#Hydraulic-conductivity" title="Permalink"></a></h1><p>The hydraulic conductivity is a more complex function than the matric potential, as it depends on the temperature of the water, the volumetric ice fraction, and the volumetric liquid water fraction. It also depends on the hydraulics model chosen.</p><p>We represent the hydraulic conductivity <code>K</code> as the product of four factors: <code>Ksat</code>, an impedance factor (which accounts for the effect of ice on conductivity) a viscosity factor (which accounts for the effect of temperature on the viscosity of liquid water, and how that in turn affects conductivity) and a moisture factor (which accounts for the effect of liquid water, and is determined by the hydraulics model). We are going to calculate <code>K = Ksat × viscosity factor × impedance factor × moisture factor</code>. In the code, each of these factors is computed by a function with multiple methods, except for <code>Ksat</code>. Like we defined new type classes for <code>vanGenuchten</code> and <code>BrooksCorey</code>, we also created new type classes for the impedance choice, the viscosity choice, and the moisture choice.</p><p>The function <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.viscosity_factor"><code>viscosity_factor</code></a> takes as arguments the temperature of the soil and the viscosity model desired, and returns the factor <code>k_v</code> by which the hydraulic conductivity is scaled. One option is to account for this effect:</p><p><span>$k_v = e^{γ (T-T_{\rm ref})}$</span></p><p>where γ = 0.0264/K and <span>$T_{\rm ref}$</span> = 288K.</p><p>For example, at the freezing point of water, using the default values for γ and T_ref, viscosity reduces the conductivity by a third:</p><pre><code class="language-julia">viscous_effect_model = TemperatureDependentViscosity{FT}();
viscosity_factor(viscous_effect_model, FT(273.15))</code></pre><pre><code class="language-none">0.67567694f0</code></pre><p>The other option is to ignore this effect:</p><p><span>$k_v = 1$</span></p><p>This is the default approach.</p><pre><code class="language-julia">no_viscous_effect_model = ConstantViscosity{FT}();
viscosity_factor(no_viscous_effect_model, FT(273.15))</code></pre><pre><code class="language-none">1.0f0</code></pre><p>Very similarly, the function <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.impedance_factor"><code>impedance_factor</code></a> takes as arguments the liquid water and ice volumetric fractions in the soil, as well as the impedance model being used, and returns the factor <code>k_i</code> by which the hydraulic conductivity is scaled. One option is to account for this effect:</p><p><span>$k_i = 10^{-Ω f_i},$</span></p><p>where <code>Ω = 7</code> is an empirical factor and <code>f_i</code> is the ratio of the volumetric ice fraction to total volumetric water fraction  (<a href="../../../../../References/#Lundin1990">L.C. Lundin  (1990)</a>).</p><p>For example, with <span>$\theta_i = \theta_l$</span>, or f_i = 0.5, ice reduces the conductivity by over 1000x.</p><pre><code class="language-julia">impedance_effect_model = IceImpedance{FT}();
impedance_factor(impedance_effect_model, FT(0.5))</code></pre><pre><code class="language-none">0.00031622776f0</code></pre><p>The other option is to ignore this effect:</p><p><span>$k_i = 1$</span></p><p>This is the default approach.</p><pre><code class="language-julia">no_impedance_effect_model = NoImpedance{FT}();
impedance_factor(no_impedance_effect_model, FT(0.5))</code></pre><pre><code class="language-none">1.0f0</code></pre><p>As for the moisture dependence of hydraulic conductivity, it can also be either independent of moisture, or dependent on moisture. If it is dependent on moisture, the specific function evaluated is dictated by the hydraulics model. The <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.moisture_factor"><code>moisture_factor</code></a> for the van Genuchten model is (denoting it as <span>$k_m$</span>)</p><p><span>$k_m = \sqrt{S_l}[1-(1-S_l^{1/m})^m]^2,$</span></p><p>for <span>$S_l &lt; 1$</span>,</p><p>and for the Brooks and Corey model it is</p><p><span>$k_m = S_l^{2M+3},$</span></p><p>also for <span>$S_l&lt;1$</span>. When <span>$S_l\geq 1$</span>, <span>$k_m = 1$</span> for each model.</p><p>Let&#39;s put all these factors together now. Below we choose additional parameters, consistent with the hydraulics parameters for sandy loam (<a href="../../../../../References/#Bonan19a">G. Bonan  (2019)</a>), and show how hydraulic conductivity varies with liquid water content, in the case without ice impedance or temperature effects.</p><pre><code class="language-julia">Ksat = FT(4.42 / (3600 * 100))
T = FT(0.0)
f_i = FT(0.0)
K =
    hydraulic_conductivity.(
        Ref(Ksat),
        Ref(impedance_factor(NoImpedance{FT}(), f_i)),
        Ref(viscosity_factor(ConstantViscosity{FT}(), T)),
        moisture_factor.(Ref(MoistureDependent{FT}()), Ref(hydraulics), S_l),
    );</code></pre><p>Let&#39;s also compute <code>K</code> when we include the effects of temperature and ice on the hydraulic conductivity. In the cases where a <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.TemperatureDependentViscosity"><code>TemperatureDependentViscosity</code></a> or <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.IceImpedance"><code>IceImpedance</code></a> type is passed, the correct factors are calculated, based on the temperature <code>T</code> and volumetric ice fraction <code>θ_i</code>.</p><pre><code class="language-julia">T = FT(273.15)
S_i = FT(0.1); # = θ_i/ν</code></pre><p>The total volumetric water fraction cannot exceed unity, so the effective liquid water saturation should have a max of 1-S_i.</p><pre><code class="language-julia">S_l_accounting_for_ice = FT.(0.01:0.01:(0.99 - S_i))
f_i = S_i ./ (S_l_accounting_for_ice .+ S_i)
K_w_factors =
    hydraulic_conductivity.(
        Ref(Ksat),
        impedance_factor.(Ref(NoImpedance{FT}()), f_i),
        Ref(viscosity_factor(ConstantViscosity{FT}(), T)),
        moisture_factor.(
            Ref(MoistureDependent{FT}()),
            Ref(hydraulics),
            S_l_accounting_for_ice,
        ),
    );
plot(
    S_l,
    log10.(K),
    xlabel = &quot;total effective saturation, (θ_i+θ_l)/ν&quot;,
    ylabel = &quot;Log10(K)&quot;,
    label = &quot;Base case&quot;,
    legend = :bottomright,
)
plot!(
    S_l_accounting_for_ice .+ S_i,
    log10.(K_w_factors),
    label = &quot;θ_i = 0.1, T = 273.15&quot;,
)
savefig(&quot;T_ice_K.png&quot;)</code></pre><p><img src="../T_ice_K.png" alt/></p><p>If the user is not considering phase transitions and does not add in Freeze/Thaw source terms, the default is for zero ice in the model, for all time and space. In this case the ice impedance factor evaluates to 1 regardless of which type is passed.</p><h1 id="Other-features"><a class="docs-heading-anchor" href="#Other-features">Other features</a><a id="Other-features-1"></a><a class="docs-heading-anchor-permalink" href="#Other-features" title="Permalink"></a></h1><p>The user also has the choice of making the conductivity constant by choosing <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.MoistureIndependent"><code>MoistureIndependent</code></a> along with <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.ConstantViscosity"><code>ConstantViscosity</code></a> and <a href="../../../../../APIs/Land/SoilWaterParameterizations/#ClimateMachine.Land.SoilWaterParameterizations.NoImpedance"><code>NoImpedance</code></a>. This is useful for debugging!</p><pre><code class="language-julia">no_moisture_dependence = MoistureIndependent{FT}()
K_constant =
    hydraulic_conductivity.(
        Ref(Ksat),
        Ref(FT(1.0)),
        Ref(FT(1.0)),
        moisture_factor.(Ref(no_moisture_dependence), Ref(hydraulics), S_l),
    );</code></pre><pre><code class="language-julia">julia&gt; unique(K_constant)
1-element Array{Float32,1}:
 1.2277777f-5</code></pre><p>Note that choosing this option does not mean the matric potential is constant, as a hydraulics model is still required and employed.</p><p>And, lastly, you might also find it helpful in debugging to be able to turn off the flow of water by setting <code>Ksat = 0</code>.</p><h1 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h1><ul><li><a href="../../../../../References/#vanGenuchten1980">M. Th. Genuchten  (1980)</a></li><li><a href="../../../../../References/#BrooksCorey1964">R. J. Brooks , A. T. Corey  (1964)</a></li><li><a href="../../../../../References/#Corey1977">A. T. Corey  (1977)</a></li><li><a href="../../../../../References/#Lundin1990">L.C. Lundin  (1990)</a></li><li><a href="../../../../../References/#Bonan19a">G. Bonan  (2019)</a></li></ul><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../Heat/heat_equation/">« Heat Equation</a><a class="docs-footer-nextpage" href="../../Heat/bonan_heat_tutorial/">Soil Heat Equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 12 November 2021 06:15">Friday 12 November 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
